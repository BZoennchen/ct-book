
<!DOCTYPE html>

<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>23. Speicher - alles ist eine Liste &#8212; Computational Thinking</title>
    
  <link href="../../_static/css/theme.css" rel="stylesheet">
  <link href="../../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/style.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script src="../../_static/translations.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../../_static/sphinx-book-theme.d59cb220de22ca1c485ebbdc042f0030.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Stichwortverzeichnis" href="../../genindex.html" />
    <link rel="search" title="Suche" href="../../search.html" />
    <link rel="next" title="24. Namensregister" href="name-register.html" />
    <link rel="prev" title="22. Binäres Zeichnen" href="image-representation.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="de">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../../_static/logo-HM-small.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Computational Thinking</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Dieses Buch durchsuchen ..." aria-label="Dieses Buch durchsuchen ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../../intro.html">
   Computational Thinking
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Einleitung
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-1/course.html">
   1. Kurskonzept
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-1/1-content.html">
     1.1. Inhalt
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-1/2-reading.html">
     1.2. Lesehinweise
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-1/3-teaching.html">
     1.3. Lehrkonzept
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-1/4-learn-how-to-think.html">
     1.4. Denken lernen?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-2/what-is-ct.html">
   2. Was ist Computational Thinking?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-2/1-informatics-and-ct.html">
     2.1. Informatik und CT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-2/2-repetition-is-the-key.html">
     2.2. Wiederholung als Grundlage
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-3/history.html">
   3. Geschichte der Computer und Algorithmen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-3/1-ancient.html">
     3.1. Antike
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-3/2-middleages.html">
     3.2. Mittelalter bis 19. Jahrhundert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-3/3-today.html">
     3.3. 19. Jahrhundert bis heute
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-3/4-future.html">
     3.4. Ausblick
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-4/why-ct.html">
   4. Warum Computational Thinking?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-4/1-intrinsic-value.html">
     4.1. Intrinsischer Wert
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-4/2-usefulness.html">
     4.2. Langfristiger Nutzen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-4/3-self-determination.html">
     4.3. Selbstbestimmt durch CT
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../01-5/sorting.html">
   5. Lasst uns Denken
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-5/1-sort-cards.html">
     5.1. Karten sortieren
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-5/2-sort-cards-with-python.html">
     5.2. Karten sortieren in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-5/3-sort-numbers.html">
     5.3. Zahlen sortieren in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../01-5/4-sort-anything.html">
     5.4. Allgemeines Sortieren in Python
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Theorie
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-0/math.html">
   6. Mathematische Grundlagen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-0/1-notation.html">
     6.1. Notation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-0/2-set.html">
     6.2. Mengen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-0/3-tuple.html">
     6.3. Tupel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-0/4-relation.html">
     6.4. Relationen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-0/5-function.html">
     6.5. Funktionen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-0/6-operations.html">
     6.6. Operationen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-0/7-induction.html">
     6.7. Vollständige Induktion
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-1/information-processing.html">
   7. Der digitale Computer
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-1/1-basics.html">
     7.1. Grundlagen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-1/2-interpretation.html">
     7.2. Interpretation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-1/2-representation.html">
     7.3. Repräsentationen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-1/3-manipulation.html">
     7.4. Manipulation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-1/4-information-flow.html">
     7.5. Der Informationskreislauf
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-1/5-hardware-equals-software.html">
     7.6. Berechenbarkeit
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-2/information.html">
   8. Was ist Information?
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-2/1-natural-science.html">
     8.1. Naturwissenschaften
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-2/2-formal-science.html">
     8.2. Strukturwissenschaften
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-2/3-critic.html">
     8.3. Kritik
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-2/4-humanics.html">
     8.4. Geisteswissenschaften
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-2/5-summary.html">
     8.5. Zusammenfassung
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-3/languages.html">
   9. Programmiersprachen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-3/1-abstraction.html">
     9.1. Abstraktion des Computers
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-3/2-success-criteria.html">
     9.2. Erfolgsfaktoren
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-3/3-imperative-vs-functional.html">
     9.3. Imperativ und funktional
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-3/4-language-evolution.html">
     9.4. Sprachevolution
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-3/5-python.html">
     9.5. Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-3/6-diversity.html">
     9.6. Diversität
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../02-4/the-art-of-programming.html">
   10. Die Kunst des Programmierens
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
  <label for="toctree-checkbox-10">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-4/1-algorithms.html">
     10.1. Algorithmen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-4/2-programming.html">
     10.2. Programmieren
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-4/3-control-structures.html">
     10.3. Kontrollstrukturen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../02-4/4-data-structures.html">
     10.4. Datenstrukturen
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Python
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../03-1/introduction.html">
   11. Programmieren in Python
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-2/python-environment.html">
   12. Das Python Ökosystem
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-2/1-installation.html">
     12.1. Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-2/2-run.html">
     12.2. Python ausführen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-2/3-notebooks.html">
     12.3. Jupyter Notebooks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-2/4-modules.html">
     12.4. Module und Pakete
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-3/intro.html">
   13. Grundlagen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-3/1-variables.html">
     13.1. Variablen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-3/2-expressions.html">
     13.2. Ausdrücke
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-3/3-invoking-functions.html">
     13.3. Funktionsaufrufe
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-4/intro.html">
   14. Datentypen (Grundlagen)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/1-data-types.html">
     14.1. Pythons Datentypen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/2-int.html">
     14.2. Ganze Zahlen - int
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/3-float.html">
     14.3. Fließkommazahlen - float
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/4-bool.html">
     14.4. Wahrheitswerte - bool
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/5-list.html">
     14.5. Listen - list
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/6-tuple.html">
     14.6. Tupel - tuple
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/7-string.html">
     14.7. Zeichenketten - str
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/8-set.html">
     14.8. Mengen - set
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/9-dict.html">
     14.9. Wörterbücher - dict
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/10-range.html">
     14.10. Zahlenbereich - range
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-4/11-typing-in-python.html">
     14.11. Python’s Typisierung
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-5/intro.html">
   15. Datentypen (Fortsetzung)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-5/1-type-systems.html">
     15.1. Dynamische und statische Typisierung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-5/2-why-data-types.html">
     15.2. Existenzberechtigung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-5/3-change-of-interpretation.html">
     15.3. Interpretationswechsel
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-5/4-kind-of-data-types.html">
     15.4. Arten von Datentypen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-5/5-primitive-data-types.html">
     15.5. Primitive Datentypen in Python?
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-6/intro.html">
   16. Funktionen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-6/1-purity.html">
     16.1. Reinheit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-6/2-definition.html">
     16.2. Grundlagen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-6/3-namespaces.html">
     16.3. Namensräume und Sichtbarkeit
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-6/4-lambdas.html">
     16.4. Anonyme Funktionen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-6/5-nested-functions.html">
     16.5. Umschlossene Funktionen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-6/x-recursion.html">
     16.6. Rekursive Funktionen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-6/6-first-class-functions.html">
     16.7. First-Class-Funktion
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-7/intro.html">
   17. Kontrollstrukturen
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
  <label for="toctree-checkbox-16">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-7/1-cases.html">
     17.1. Fallunterscheidungen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-7/2-loops.html">
     17.2. Schleifen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-7/3-comprehensions.html">
     17.3. Comprehensions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-8/intro.html">
   18. Objektorientierte Programmierung
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-8/1-class-and-objects.html">
     18.1. Klassen und Objekte
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-8/2-inheritance-poly-encap.html">
     18.2. Vererbung, Kapselung und Polymorphie
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../03-9/cpython.html">
   19. CPython
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-9/1-impl.html">
     19.1. Implementierungen
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-9/2-ref.html">
     19.2. Referenzimplementierung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-9/3-interpreter.html">
     19.3. Interpreter und Compiler
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-9/4-disassembly.html">
     19.4. Zerlegung
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../03-9/5-extending.html">
     19.5. CPython erweitern
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  CT in Aktion
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="robo-world.html">
   20. Roboterwelt
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="dive-bell.html">
   21. Sprechen in der Taucherglocke
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="image-representation.html">
   22. Binäres Zeichnen
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   23. Speicher - alles ist eine Liste
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="name-register.html">
   24. Namensregister
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Appendix
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../misc/bibliography.html">
   Bibliography
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Unterstützt durch <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Navigation umschalten" aria-controls="site-navigation"
                title="Navigation umschalten" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Laden Sie diese Seite herunter"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../../_sources/chapters/04/memory.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Notebook-Datei herunterladen" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/chapters/04/memory.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Quelldatei herunterladen" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="In PDF drucken"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/BZoennchen/ct-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Quell-Repository"><i
                    class="fab fa-github"></i>Repository</button></a>
        <a class="issues-button"
            href="https://github.com/BZoennchen/ct-book/issues/new?title=Issue%20on%20page%20%2Fchapters/04/memory.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Öffnen Sie ein Problem"><i class="fas fa-lightbulb"></i>offenes Thema</button></a>
        <a class="edit-button" href="https://github.com/BZoennchen/ct-book/edit/master/chapters/04/memory.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Bearbeite diese Seite"><i class="fas fa-pencil-alt"></i>vorschlagen zu bearbeiten</button></a>
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Vollbildmodus"
        title="Vollbildmodus"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/BZoennchen/ct-book/master?urlpath=tree/chapters/04/memory.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Starten Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Starten Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Inhalt
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arbeitsspeicher-als-python-liste">
   23.1. Arbeitsspeicher als Python-Liste?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adressierung">
     23.1.1. Adressierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#primitive-datentypen">
     23.1.2. Primitive Datentypen
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modellierung-des-arbeitsspeichers">
   23.2. Modellierung des Arbeitsspeichers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialisierung">
     23.2.1. Initialisierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datentypen">
     23.2.2. Datentypen
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#zeichenketten">
       23.2.2.1. Zeichenketten
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#zeichen">
       23.2.2.2. Zeichen
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#naturliche-zahlen">
       23.2.2.3. Natürliche Zahlen
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#speicheradressen">
       23.2.2.4. Speicheradressen
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#listen">
       23.2.2.5. Listen
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementierung">
   23.3. Implementierung
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#speicher-initialisieren">
     23.3.1. Speicher initialisieren
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#speicherverwaltung-fur-primitive-datentypen">
     23.3.2. Speicherverwaltung für primitive Datentypen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#addieren-im-speicher">
     23.3.3. Addieren im Speicher
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#speicherverwaltung-fur-listen">
     23.3.4. Speicherverwaltung für Listen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mehrdimensionale-listen">
     23.3.5. Mehrdimensionale Listen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ein-einfacher-parser">
     23.3.6. Ein einfacher Parser
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#listen-erzeugen">
     23.3.7. Listen erzeugen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ende-der-reise">
     23.3.8. Ende der Reise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#memory-klasse">
     23.3.9. Memory Klasse
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#was-soll-das-alles">
   23.4. Was soll das alles?
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Speicher - alles ist eine Liste</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Inhalt </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#arbeitsspeicher-als-python-liste">
   23.1. Arbeitsspeicher als Python-Liste?
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#adressierung">
     23.1.1. Adressierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#primitive-datentypen">
     23.1.2. Primitive Datentypen
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#modellierung-des-arbeitsspeichers">
   23.2. Modellierung des Arbeitsspeichers
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#initialisierung">
     23.2.1. Initialisierung
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#datentypen">
     23.2.2. Datentypen
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#zeichenketten">
       23.2.2.1. Zeichenketten
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#zeichen">
       23.2.2.2. Zeichen
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#naturliche-zahlen">
       23.2.2.3. Natürliche Zahlen
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#speicheradressen">
       23.2.2.4. Speicheradressen
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#listen">
       23.2.2.5. Listen
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#implementierung">
   23.3. Implementierung
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#speicher-initialisieren">
     23.3.1. Speicher initialisieren
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#speicherverwaltung-fur-primitive-datentypen">
     23.3.2. Speicherverwaltung für primitive Datentypen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#addieren-im-speicher">
     23.3.3. Addieren im Speicher
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#speicherverwaltung-fur-listen">
     23.3.4. Speicherverwaltung für Listen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#mehrdimensionale-listen">
     23.3.5. Mehrdimensionale Listen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ein-einfacher-parser">
     23.3.6. Ein einfacher Parser
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#listen-erzeugen">
     23.3.7. Listen erzeugen
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#ende-der-reise">
     23.3.8. Ende der Reise
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#memory-klasse">
     23.3.9. Memory Klasse
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#was-soll-das-alles">
   23.4. Was soll das alles?
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="section" id="speicher-alles-ist-eine-liste">
<span id="sec-memory"></span><h1><span class="section-number">23. </span>Speicher - alles ist eine Liste<a class="headerlink" href="#speicher-alles-ist-eine-liste" title="Link zu dieser Überschrift">¶</a></h1>
<p>Wie funktioniert der <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> im Detail?
Wie werden Daten in ihm abgelegt und wie gelangt die <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> zu diesen zu verarbeitenden Daten?
Warum gibt es <a class="reference internal" href="../03-4/intro.html#sec-python-data-types"><span class="std std-ref">Datentypen</span></a>?
Wie manipulieren wir Daten die im Speicher liegen?
Was sind und warum gibt es Speicheradressen und wie wird aus einem Speicherbereich eine Datenstruktur?
Diesen Fragen wollen wir in diesem Abschnitt nachgehen.</p>
<div class="learngoals admonition">
<p class="admonition-title">Lernziel</p>
<p>Diese Übung bietet Ihnen eine Erklärung wie aus einer langen Liste aus <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bits</span></a> und <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Bytes</span></a>, d.h. dem <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a>, Zahlen, Zeichen und Listen und
andere Datentypen entstehen.
Sie werden begreifen weshalb es Datentypen gibt und weshalb am Ende des Tages alle Daten durch eine lange Liste aus Zahlen realisiert werden.</p>
<p>Sie werden den Prozess der Abstraktion, von einer konkreten in eine abstrakte Welt, im Detail betrachten und dadurch besser verstehen.</p>
</div>
<p>Um ein tiefgreifendes Verständnis zu erwecken, reicht es uns nicht diese Fragen rein theoretisch zu beantworten.
Stattdessen erarbeiten wir uns Antworten indem wir selbst Teile des <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> und dessen Handhabung <em>modellieren</em> und implementieren.
Dazu werden wir uns selbst, wie man salopp sagt, ins Knie schießen und uns zunächst stark einschränken.</p>
<p>Den <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> <em>modellieren</em> wir durch eine <code class="docutils literal notranslate"><span class="pre">Python</span></code>-<a class="reference internal" href="../03-4/5-list.html#sec-list"><span class="std std-ref">Liste</span></a>, welche ausschließlich natürliche Zahlen von 0 bis 255, also 1 <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Byte</span></a>, enthalten darf.</p>
<p>Warum modellieren wir den Speicher durch eine <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Liste?
Bei genauer Betrachtung ist der <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> nichts anderes als eine sehr sehr lange Liste.
Jeder 8-<a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">bit</span></a>-Speicherbereich hat seine eigene eindeutige Adresse.
Der <a class="reference internal" href="../02-1/4-information-flow.html#def-program-counter"><span class="std std-ref">Befehlszeiger</span></a> der Kontrolleinheit zeigt auf die aktuelle zu lesende / zu beschreibende Speicheradresse.
Der Inhalt wird in ein <a class="reference internal" href="../02-1/4-information-flow.html#def-register"><span class="std std-ref">Register</span></a> der <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> geladen und dort verarbeitet.
Zudem kann die <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> Ergebnisse an die Adresse des Befehlszeigers schreiben.
Aufgrund der Befehle, welche aus dem <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> geladen werden, verändert die Kontrolleinheit den Befehlszeiger entsprechend, d.h., die Kontrolleinheit führt das im Speicher stehende Programm aus.</p>
<div class="figure align-default" id="fig-program-run-memory">
<a class="reference internal image-reference" href="../../_images/program-run.png"><img alt="../../_images/program-run.png" src="../../_images/program-run.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Abb. 23.1 </span><span class="caption-text">Bereiche des <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeichers</span></a> (links) werden über eine Speicheradresse in <a class="reference internal" href="../02-1/4-information-flow.html#def-register"><span class="std std-ref">Register</span></a> der <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> (Kontrolleinheit und arithmetische/logische Einheit) geladen.</span><a class="headerlink" href="#fig-program-run-memory" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Warum darf die Liste nur Zahlen enthalten?
Der gesamte Computer arbeitet mit Zahlen in der <a class="reference internal" href="../02-1/2-representation.html#sec-binary-numbers"><span class="std std-ref">Binärdarstellung</span></a>.
Dabei kann jeder Speicher des Computers nur eine endlich große Zahl aufnehmen, da Speicher bzw. dessen Bauteile endliche Ressourcen sind.
Wir wählen die Dezimaldarstellung um es uns ein wenig einfacher und lesbarer zu gestalten.</p>
<p>Die <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> und deren <a class="reference internal" href="../02-1/4-information-flow.html#def-register"><span class="std std-ref">Register</span></a> werden wir nicht modellieren, deshalb gehen wir davon aus, dass in unserem Speicher nur Daten und keine Anweisungen bzw. Programme stehen.</p>
<div class="exercise admonition" id="memory-finite-real-numbers-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.1 </span> (Endlichkeit und reelle Zahlen)</p>
<div class="section" id="exercise-content">
<p>Kann der Computer die Kreiszahl <span class="math notranslate nohighlight">\(\pi\)</span> als numerischen Wert im Speicher halten?</p>
</div>
</div>
<div class="solution dropdown admonition" id="memory-finite-real-numbers-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-finite-real-numbers-exercise"> Exercise 23.1 (Endlichkeit und reelle Zahlen)</a></p>
<div class="section" id="solution-content">
<p>Nein! Die Kreiszahl <span class="math notranslate nohighlight">\(\pi\)</span> hat niedergeschrieben unendlich viele sich nicht wiederholende Nachkommastellen.
Die Speicherressourcen eines Computers sind jedoch endlich.</p>
</div>
</div>
<p>Durch diese künstliche Einschränkung rücken wir näher an die konkrete Maschine heran.
Daraufhin werden wir uns selbständig wieder von ihr entfernen.
Dieser Prozess soll Ihnen aufzeigen, wie wir aus einer sehr konkreten Welt der Register, elektrischen Schaltungen und des endlichen Speichers, in eine abstrakte Welt der <a class="reference internal" href="../02-4/4-data-structures.html#sec-data-structures"><span class="std std-ref">Datenstrukturen</span></a> und <a class="reference internal" href="../02-4/1-algorithms.html#def-algorithm"><span class="std std-ref">Algorithmen</span></a> gelangen.
Dieser Prozess des Abstrahierens ist ein wesentlicher Bestandteil des <a class="reference internal" href="../01-2/what-is-ct.html#sec-what-is-ct"><span class="std std-ref">Computational Thinkings</span></a> und kann auf vielerlei Probleme angewendet werden.</p>
<p>Ihnen wird diese Übung möglichweise sehr kleinlich und technisch vorkommen und damit liegen Sie richtig.
Die konkrete Welt ist kleinlich und technisch.
Programmieren Sie in <code class="docutils literal notranslate"><span class="pre">Python</span></code> bewegen Sie sich bereits in einer abstrakten Welt.
Vergleichen Sie <a class="reference internal" href="../02-4/1-algorithms.html#fig-world-code-computer"><span class="std std-numref">Abbildung 10.1</span></a>.
Jede Welt lässt sich jedoch weiter abstrahieren.
Für die <code class="docutils literal notranslate"><span class="pre">Assembler</span></code>-Programmierer*innen bietet <code class="docutils literal notranslate"><span class="pre">C</span></code> eine hohe Abstraktion und für die <code class="docutils literal notranslate"><span class="pre">C</span></code>-Programmierer*innen ist <code class="docutils literal notranslate"><span class="pre">Python</span></code> abstrakt.
Bauen Sie Programme mit <code class="docutils literal notranslate"><span class="pre">Pyhton</span></code>, so sind diese eine weitere Abstraktion.
Die Fähigkeit des Abstrahierens bleibt auf allen Ebenen essenziell.
Von wo aus wir mit der Abstraktion starten und wo wir hinaufsteigen, ist für das Lernen dieses Prozesses weniger wichtig.
Wichtig ist der Weg und den beschreiten wir hier!</p>
<div class="section" id="arbeitsspeicher-als-python-liste">
<h2><span class="section-number">23.1. </span>Arbeitsspeicher als Python-Liste?<a class="headerlink" href="#arbeitsspeicher-als-python-liste" title="Link zu dieser Überschrift">¶</a></h2>
<div class="section" id="adressierung">
<h3><span class="section-number">23.1.1. </span>Adressierung<a class="headerlink" href="#adressierung" title="Link zu dieser Überschrift">¶</a></h3>
<p>Werfen wir einen kurzen Blick auf die Eigenschaften und Funktionsweise des <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeichers</span></a>.
Ignorieren wir den <a class="reference internal" href="../02-1/4-information-flow.html#def-cache"><span class="std std-ref">Cache</span></a>, so greift die <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> direkt auf den <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> zu.
Ist unsere <em>Rechnerarchitektur</em> eine <a class="reference internal" href="../02-1/4-information-flow.html#sec-von-neumann"><span class="std std-ref">Von-Neumann-Architektur</span></a>, so befinden sich im <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> die <strong>gerade</strong> auszuführenden Anweisungen (das Programm) als auch die Daten die verarbeitet werden.</p>
<p>Der <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> wird auch <strong>Random Access Memory</strong> genannt.
Der Name betont, dass egal auf welche Speicherstelle die <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> zugreift (random access), dieser Zugriff in etwa die gleiche Zeit in Anspruch nimmt.
Genauer gesagt eine bestimmte Anzahl an Zyklen.
Diese Zeit ist viel viel kürzer als der Zugriff auf persistente Speicher, wie etwa die Festplatte.</p>
<p>Der Speicher ist unterteilt in 8-<a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">bit</span></a> (1-<a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">byte</span></a>) Bereiche.
Wenn die <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> auf einen Speicherbereich zugreifen möchte, so <strong>adressiert</strong> sie diesen Bereich über eine <strong>Speicheradresse</strong>.
Die Adresse, als auch der Inhalt des gesamten Speichers ist <a class="reference internal" href="../02-1/2-representation.html#sec-binary-numbers"><span class="std std-ref">binär codiert</span></a>.</p>
<p>Der Zugriff auf den Inhalt einer <code class="docutils literal notranslate"><span class="pre">Python</span></code>-<a class="reference internal" href="../03-4/5-list.html#sec-list"><span class="std std-ref">Liste</span></a> funktioniert ähnlich.
Auch hier greifen wir über eine <strong>Adresse</strong> auf einen <strong>Bereich</strong>, d.h. ein <strong>Listenelement</strong>, zu.
Diese Adresse nennen wir <strong>Index</strong>.
Sie ist eine Dezimalzahl welche zwischen 0 und (Länger der Liste - 1) liegt.
In einem <strong>Speicherbereich</strong> des <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> stehen exakt 8 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a>, dies gilt für eine <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Liste nicht.
Diese ist viel flexibler und kann allerart von Daten enthalten.</p>
<p>Modellieren wir unsere Speicheradressen als Listenindices und sind die Listenelemente natürliche Zahlen von 0 bis 255, so kommen wir schon sehr nah an die Beschränkungen bzw. Einfachheit des <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeichers</span></a> heran.</p>
</div>
<div class="section" id="primitive-datentypen">
<h3><span class="section-number">23.1.2. </span>Primitive Datentypen<a class="headerlink" href="#primitive-datentypen" title="Link zu dieser Überschrift">¶</a></h3>
<p>In <code class="docutils literal notranslate"><span class="pre">Python</span></code> können wir bequem mit unterschiedlichen <a class="reference internal" href="../03-4/intro.html#sec-python-data-types"><span class="std std-ref">Datentypen</span></a> umgehen.
Gewöhnlich unterteilt man Datentypen einer Programmiersprache in zwei Typen:</p>
<ol class="simple">
<li><p>den <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitiven</span></a> und den</p></li>
<li><p><a class="reference internal" href="../03-4/1-data-types.html#def-data-structures"><span class="std std-ref">zusammengesetzten Datentypen</span></a></p></li>
</ol>
<p>In <code class="docutils literal notranslate"><span class="pre">Python</span></code> gibt es jedoch keine <strong>primitive Datentypen</strong>.
Wie in Abschnitt <a class="reference internal" href="../03-5/intro.html#sec-data-types-advanced"><span class="std std-ref">Datentypen</span></a> besprochen, ist jeder Datentyp in <code class="docutils literal notranslate"><span class="pre">Python</span></code> ein <a class="reference internal" href="../03-4/1-data-types.html#def-atomare-data-types"><span class="std std-ref">atomarer</span></a> oder <a class="reference internal" href="../03-4/1-data-types.html#def-data-structures"><span class="std std-ref">zusammengesetzter Datentyp</span></a>!</p>
<p>In <code class="docutils literal notranslate"><span class="pre">Java</span></code> gibt es zum Beispiel folgende primitiven Datentypen:</p>
<ul class="simple">
<li><p>ganzen Zahlen <code class="docutils literal notranslate"><span class="pre">byte</span></code> (8-Bit)</p></li>
<li><p>ganzen Zahlen <code class="docutils literal notranslate"><span class="pre">short</span></code> (16-Bit)</p></li>
<li><p>ganzen Zahlen <code class="docutils literal notranslate"><span class="pre">int</span></code> (32-Bit)</p></li>
<li><p>ganzen Zahlen <code class="docutils literal notranslate"><span class="pre">long</span></code> (64-Bit)</p></li>
<li><p>Zeichen <code class="docutils literal notranslate"><span class="pre">char</span></code> (16-Bit)</p></li>
<li><p>Fließkommazahlen <code class="docutils literal notranslate"><span class="pre">float</span></code> (32-Bit)</p></li>
<li><p>Fließkommazahlen <code class="docutils literal notranslate"><span class="pre">double</span></code> (64-Bit)</p></li>
<li><p>boolsche Werte <code class="docutils literal notranslate"><span class="pre">boolean</span></code> (1-Bit)</p></li>
</ul>
<p>Sie sehen, dass es für ganze Zahlen und Gleitkommazahlen mehrere Datentypen gibt, dessen Werte unterschiedlich viel Platz verbrauchen können.</p>
<div class="remark admonition" id="remark-memory-of-primitive-data-types">
<p class="admonition-title">Speicherverbrauch primitiver Datentypen</p>
<p>Der Speicherplatz, den ein Wert eines primitiven Datentyps verbraucht ist durch den Datentyp festgelegt und variiert nicht!</p>
</div>
<p>Obwohl es diese primitiven Datentypen in <code class="docutils literal notranslate"><span class="pre">Python</span></code> nicht gibt, stellen wir uns für diese Übung vor, dass auch alle atomaren Datentypen eine feste und bestimmte Anzahl an Bits verbrauchen (dies ist für <code class="docutils literal notranslate"><span class="pre">int</span></code> nicht wahr!).</p>
<p>Sie werden in fast allen anderen Sprachen mit primitiven Datentypen in Berührung kommen und auch in <code class="docutils literal notranslate"><span class="pre">Python</span></code> verhalten sich <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code> und co. sehr ähnlich.
Zum Beispiel sind die Werte von atomaren Datentypen <em>unveränderlich</em> (engl. <em>immutable</em>).</p>
<p>Weshalb es diese Aufteilung gibt und wie aus <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bits</span></a> und <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Bytes</span></a> verschiedene Datentypen entstehen erfahren sie in dieser Übung. Zusätzlich verweisen wir auf die Kapitel <a class="reference internal" href="../03-4/intro.html#sec-python-data-types"><span class="std std-ref">Datentypen (Grundlagen)</span></a> und <a class="reference internal" href="../03-5/intro.html#sec-data-types-advanced"><span class="std std-ref">Datentypen (Fortsetzung)</span></a>.</p>
<p>Wie es möglich ist, dass wir in <code class="docutils literal notranslate"><span class="pre">Python</span></code> mit all den schönen Datentypen und Datenstrukturen hantieren können, werden wir uns nun Schritt für Schritt erarbeiten.
Wir werden uns in dieser Übung auf die <em>Modellierung</em> von Zahlen, Zeichen und Listen beschränken.</p>
<p>Wie der Titel dieser Übung suggeriert, ist alles eine Liste und so ist die Basis des <a class="reference internal" href="dive-bell.html#def-python-dictionary"><span class="std std-ref">Dictionary</span></a> ebenfalls eine Liste.
Wenn Sie erfahren wollen wie aus einer Liste ein <a class="reference internal" href="dive-bell.html#def-python-dictionary"><span class="std std-ref">Dictionary</span></a> wird, empfehlen wir Ihnen das Kapitel <a class="reference internal" href="name-register.html#sec-name-register"><span class="std std-ref">Namensregister</span></a>, insbesondere den Abschnitt <a class="reference internal" href="name-register.html#sec-hashing"><span class="std std-ref">Hashing und das Dictionary</span></a>.</p>
<div class="exercise admonition" id="memory-expensive-float-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.2 </span> (Speicherverbrauch von Fließkommazahlen)</p>
<div class="section" id="exercise-content">
<p>Finden Sie heraus wie viel Speicher ein <code class="docutils literal notranslate"><span class="pre">float</span></code> Wert in <code class="docutils literal notranslate"><span class="pre">Python</span></code> verbraucht.</p>
</div>
</div>
<div class="solution dropdown admonition" id="memory-expensive-float-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-expensive-float-exercise"> Exercise 23.2 (Speicherverbrauch von Fließkommazahlen)</a></p>
<div class="section" id="solution-content">
<p>Die Antwort hängt von Ihrem System und Ihrer <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Version ab.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.313</span>
<span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sys</span>
<span class="n">x</span> <span class="o">=</span> <span class="mf">1.313</span>
<span class="n">sys</span><span class="o">.</span><span class="n">getsizeof</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>24
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="modellierung-des-arbeitsspeichers">
<h2><span class="section-number">23.2. </span>Modellierung des Arbeitsspeichers<a class="headerlink" href="#modellierung-des-arbeitsspeichers" title="Link zu dieser Überschrift">¶</a></h2>
<p>Wir wählen als Basis die <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Liste und interpretieren den <strong>Index</strong> der Liste als <strong>Speicheradresse</strong> und den <strong>Listeneintrag</strong> als <strong>Speicherbereich</strong>.
Wir verzichten auf die Binärschreibweise und arbeiten stattdessen aus Gründen der Lesbarkeit mit Dezimalzahlen.
Jedoch soll auch für unsere Liste gelten, dass</p>
<ol class="simple">
<li><p>sie nur Dezimalzahlen beinhalten darf und</p></li>
<li><p>diese durch 8 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> darstellbar sind.</p></li>
</ol>
<div class="figure align-default" id="fig-list-as-memory">
<a class="reference internal image-reference" href="../../_images/list-as-memory.png"><img alt="../../_images/list-as-memory.png" src="../../_images/list-as-memory.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Abb. 23.2 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">Python</span></code>-Liste von natürlichen Zahlen als Modell für den <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a>.</span><a class="headerlink" href="#fig-list-as-memory" title="Link zu diesem Bild">¶</a></p>
</div>
<div class="exercise admonition" id="memory-decimal-numbers-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.3 </span> (Kapazität des Speicherbereichs)</p>
<div class="section" id="exercise-content">
<p>Wie lautet die größte positive Dezimalzahl die wir in einem adressierbaren Speicherbereich, d.h., einem Listeneintrag halten können, sofern wir das <a class="reference internal" href="../02-1/2-representation.html#sec-integers"><span class="std std-ref">Zweierkomplement</span></a> als Codierung verwenden?</p>
</div>
</div>
<div class="solution dropdown admonition" id="memory-decimal-numbers-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-decimal-numbers-exercise"> Exercise 23.3 (Kapazität des Speicherbereichs)</a></p>
<div class="section" id="solution-content">
<p>Die Zahl <span class="math notranslate nohighlight">\(0111\, 1111_2\)</span> in Binärschreibweise ist die größte positive die wir darstellen können.
Binär ergibt dies <span class="math notranslate nohighlight">\(0\,1000\,0000_2 - 1_2\)</span> (binär) was wiederum gleich</p>
<div class="math notranslate nohighlight">
\[
2^7 - 1 = 127_{10}
\]</div>
<p>(dezimal) ist.</p>
</div>
</div>
<p>Im <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> eines Computers, der die <a class="reference internal" href="../02-1/4-information-flow.html#sec-von-neumann"><span class="std std-ref">Von-Neumann-Architektur</span></a> realisiert, liegen <strong>Daten</strong> wie auch <strong>Anweisungen</strong>.
Damit es nicht zu kompliziert wird, werden wir in dieser Übung uns nur auf die <strong>Daten</strong> konzentrieren und die Anweisungen außer acht lassen.
Wir gehen also davon aus, dass die <em>Kontrolleinheit</em> (siehe <a class="reference internal" href="../02-1/4-information-flow.html#sec-run-program"><span class="std std-ref">Programmausführung</span></a>) Ihre Befehle wie in der <a class="reference internal" href="../02-1/4-information-flow.html#remark-neumann-vs-harvard"><span class="std std-ref">Harvard Architektur</span></a> von einem anderen Speicher lädt.
Diesen modellieren wir nicht.</p>
<p>Die Ausführung der Befehle simulieren wir als <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Code, d.h. wir erlauben uns ganz normalen <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Code für die Manipulation des Speichers zu schreiben.
Bedenken Sie jedoch, dass in der Realität dieser Code ebenfalls im <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> stehen würde, dass Variablen in Register geladen werden müssten und <code class="docutils literal notranslate"><span class="pre">if</span></code>-Ausdrücke wie auch Schleifen durch Veränderungen des <em>Befehlszeigers</em> realisiert werden!</p>
<div class="section" id="initialisierung">
<h3><span class="section-number">23.2.1. </span>Initialisierung<a class="headerlink" href="#initialisierung" title="Link zu dieser Überschrift">¶</a></h3>
<p>Der <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> ist riesig, d.h., wir arbeiten mit einer großen Liste.
In seinem Initialzustand steht im <em>flüchtige</em> Speicher kein festgelegter Wert.
Wir initialisieren unseren Speicher mit lauter Nullen.
Den Speicher modellieren wir durch eine lange eindimensionale Liste namens <code class="docutils literal notranslate"><span class="pre">memory</span></code>.</p>
<p>Programme, die durch die <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> auf Speicherbereiche zugreifen, dürfen sich ihren Speicher nicht gegenseitig überschreiben bzw. in den Speicherbereich eines anderen Programms schreiben.
Deshalb ist es notwendig Speicher zu reservieren und, da dieser endlich ist, wieder freizugeben.</p>
<div class="definition admonition" id="def-allocation">
<p class="admonition-title">Speicher allokieren</p>
<p>Das Reservieren von Speicherbereichen des <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> nennen wir <em>Allokation</em>.</p>
</div>
<p>Woher wissen wir, wann ein Speicherbereich ungenutzt/frei bzw. genutzt/reserviert ist?
Steht in einem Speicherbereich eine Null, deutet das erst einmal auf den Wert Null und nicht auf einen freien Bereich hin.
Was wir brauchen ist eine Markierung die uns über den Zustand des Speicherbereichs <strong>allokiert</strong> oder <strong>frei</strong> informiert.</p>
<p>Wir könnten dafür eines der 8 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> eines Speicherbereichs verwenden.
Diese 1-<a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> Markierung könnte anzeigen, dass dieser Speicherbereich nicht <strong>allokiert</strong> ist 1 oder <strong>frei</strong> 0.
Dadurch könnten wir jedoch nur noch 128 verschiedene Zahlen pro Speicherbereich darstellen.
Außerdem müssten wir dann immer wenn wir einen Speicherbereich nicht mehr verwenden, diese Zahl hineinschreiben.</p>
<p>Wir verwenden für die Markierung stattdessen eine zweite Liste <code class="docutils literal notranslate"><span class="pre">inuse</span></code>.</p>
<div class="exercise admonition" id="memory-in-use-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.4 </span> (Speicherbelegung)</p>
<div class="section" id="exercise-content">
<p>Wie könnte eine zweite Liste uns Aufschluss geben ob ein Speicherbereich in Verwendung ist oder nicht?
Wie viel Speicher würde diese Liste benötigen?</p>
</div>
</div>
<div class="solution dropdown admonition" id="memory-in-use-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-in-use-exercise"> Exercise 23.4 (Speicherbelegung)</a></p>
<div class="section" id="solution-content">
<p>Eine zweite Liste <code class="docutils literal notranslate"><span class="pre">inuse[i]</span></code> könnte durch einen boolschen Wert <code class="docutils literal notranslate"><span class="pre">True</span></code> oder <code class="docutils literal notranslate"><span class="pre">False</span></code> anzeigen, dass der Speicherbereich an der Stelle <code class="docutils literal notranslate"><span class="pre">i</span></code> allokiert ist oder nicht.</p>
<p>Jeder Eintrag braucht 1 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a>.
Damit bräuchte die Liste <span class="math notranslate nohighlight">\(n\)</span> Bit, wobei <span class="math notranslate nohighlight">\(n\)</span> die Anzahl der Speicherbereiche (Länge der Liste) ist.</p>
</div>
</div>
</div>
<div class="section" id="datentypen">
<span id="sec-memory-datatypes"></span><h3><span class="section-number">23.2.2. </span>Datentypen<a class="headerlink" href="#datentypen" title="Link zu dieser Überschrift">¶</a></h3>
<blockquote>
<div><p>Was sind Datentypen und weshalb brauchen wir diese?</p>
</div></blockquote>
<p>In unserem Speicher <code class="docutils literal notranslate"><span class="pre">memory</span></code> befinden sich nur natürliche Zahlen von 0 bis 255.
Doch möchten wir natürlich auch Zeichen oder größere Zahlen repräsentieren.
Für interpretierte dynamisch getypte Sprachen wie <code class="docutils literal notranslate"><span class="pre">Python</span></code> (siehe Abschnitt <a class="reference internal" href="../03-4/11-typing-in-python.html#sec-typing-in-python"><span class="std std-ref">Python’s Typisierung</span></a>) benötigt der <a class="reference internal" href="../02-1/2-interpretation.html#def-interpreter"><span class="std std-ref">Interpreter</span></a> Information darüber, wie er bestimmter Speicherbereich, d.h., ein Listenelement <code class="docutils literal notranslate"><span class="pre">memory[i]</span></code> zu interpretieren hat.</p>
<p>Datentypen liefern diese Information.
Neben dem eigentlichen Wert beschreiben sie, wie dieser Wert zu interpretieren ist!</p>
<p>Da in <code class="docutils literal notranslate"><span class="pre">memory</span></code> nur Zahlen stehen können, ist auch diese Datentypinformation als Zahl codiert.
Brauchen wir dann nicht eine weitere Information die uns sagt, dass es sich bei diesem oder jenem Speicherbereich um die Datentypinformation handelt?
Wenn ja kommen wir aus dem Schlamassel nicht mehr heraus.</p>
<div class="figure align-default" id="fig-data-type-key-pair">
<a class="reference internal image-reference" href="../../_images/data-type-key-pair1.png"><img alt="../../_images/data-type-key-pair1.png" src="../../_images/data-type-key-pair1.png" style="width: 250px;" /></a>
<p class="caption"><span class="caption-number">Abb. 23.3 </span><span class="caption-text">(Datentyp, Wert)-Paar.</span><a class="headerlink" href="#fig-data-type-key-pair" title="Link zu diesem Bild">¶</a></p>
</div>
<p>Die Datentypinformation ist eine <strong>explizite</strong> Information, d.h. die Information wird niedergeschrieben.
Um zu entscheiden, ob ein Speicherbereich den Datentyp beschreibt, verwenden wir hingegen <strong>implizites</strong> Wissen/Information.
Wir einigen uns einfach darauf, dass ein Paar (Datentyp, Wert) mit dem Datentyp beginnt und dieser genau durch das erste <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Byte</span></a> beschrieben wird.
Wenn wir wissen, dass ein solches Paar an der Adresse / Index <code class="docutils literal notranslate"><span class="pre">i</span></code> beginnt, können wir den Datentyp aus dem Speicherbereich <code class="docutils literal notranslate"><span class="pre">memory[i]</span></code> herauslesen.
Zu wissen, wo ein solches Paar beginnt, ist eine notwendige Voraussetzung.</p>
<p>Wir beschränken uns auf die folgenden Datentypen, wovon die Werte der <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitiven Datentypen</span></a> einen festen Speicherbedarf benötigen.</p>
<ol class="simple">
<li><p>die <a class="reference internal" href="#sec-memory-natural-numbers"><span class="std std-ref">natürlichen Zahlen</span></a>, 16-Bit</p></li>
<li><p><a class="reference internal" href="#sec-memory-char"><span class="std std-ref">Zeichen</span></a>, 8-Bit</p></li>
<li><p><a class="reference internal" href="#sec-memory-address"><span class="std std-ref">Speicheradressen</span></a>, 16-Bit</p></li>
<li><p><a class="reference internal" href="#sec-memory-list"><span class="std std-ref">Listen</span></a>, variabler Speicherbedarf</p></li>
<li><p>(<a class="reference internal" href="#sec-memory-string"><span class="std std-ref">Zeichenketten</span></a>, variabler Speicherbedarf)</p></li>
</ol>
<p>Zeichenketten oder Listen sind von keinem <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitiven Datentyp</span></a>, denn sie haben eine variable Länge und können weiter zerlegt werden.
Die Festlegung des Speicherbedarfs für <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitive Datentyp</span></a> bedeutet auch, dass wir für kleine Zahlen, z.B., die 0 mehr Speicher verbrauchen als eigentlich notwendig.
Weshalb diese Lösung dennoch besser ist als einen variable Speicherbedarf zu verwalten wird gleich ersichtlich.
Jetzt wird Ihnen vielleicht auch klar warum es in <code class="docutils literal notranslate"><span class="pre">Java</span></code> und <code class="docutils literal notranslate"><span class="pre">C/C++</span></code> verschiedene Datentypen für ganze Zahlen gibt.</p>
<p>Fassen wir noch einmal die impliziten und expliziten Informationen zusammen.</p>
<ul class="simple">
<li><p><strong>Explizite Information:</strong> Eine Zahl steht für einen bestimmten Datentyp:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> bedeutet, dass das was folgt eine natürlichen Zahl ist (wir verzichten auf negative Zahlen)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> bedeutet, dass das was folgt ein Zeichen ist</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> bedeutet, dass das was folgt eine Liste ist</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> bedeutet, dass das was folgt eine Speicheradresse ist</p></li>
</ul>
</li>
<li><p><strong>Implizite Information:</strong> Jedes Objekt (Zahl, Buchstabe, Liste, Adresse) beginnt mit der Datentypinformation. Den Speicherbedarf je Datentyp nehmen wir ebenfalls implizit an.</p></li>
</ul>
<div class="section" id="zeichenketten">
<span id="sec-memory-string"></span><h4><span class="section-number">23.2.2.1. </span>Zeichenketten<a class="headerlink" href="#zeichenketten" title="Link zu dieser Überschrift">¶</a></h4>
<p>Haben wir nicht die Zeichenketten vergessen?
Eine Zeichenkette ist nichts anderes als eine Liste von Zeichen und diese beiden Datentypen haben wir bereits berücksichtigt.</p>
</div>
<div class="section" id="zeichen">
<span id="sec-memory-char"></span><h4><span class="section-number">23.2.2.2. </span>Zeichen<a class="headerlink" href="#zeichen" title="Link zu dieser Überschrift">¶</a></h4>
<p>256 unterschiedliche Zahlen, reichen uns aus um einfache Texte mit <code class="docutils literal notranslate"><span class="pre">a-z</span></code>, <code class="docutils literal notranslate"><span class="pre">A-Z</span></code> und die Sonderzeichen <code class="docutils literal notranslate"><span class="pre">.</span></code>, <code class="docutils literal notranslate"><span class="pre">,</span></code>, <code class="docutils literal notranslate"><span class="pre">?</span></code>, <code class="docutils literal notranslate"><span class="pre">!</span></code> zu codieren.
Im Speicherbereich, der auf den Bereich des Datentyps (<code class="docutils literal notranslate"><span class="pre">1</span></code>) folgt, können wir demnach das Zeichen als Zahl hineinschreiben.</p>
<p>Mittels Codierung, welche uns für eine Zahl ein Zeichen ausspuckt (implizites Wissen), können wir einzelne Buchstaben in den Speicher schreiben und von diesem lesen.
Sie können sich Ihre eigene Codierung überlegen oder die <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Funktionen <a class="reference external" href="https://www.w3schools.com/python/ref_func_ord.asp">ord</a> und <a class="reference external" href="https://www.w3schools.com/python/ref_func_chr.asp">chr</a> verwenden.</p>
</div>
<div class="section" id="naturliche-zahlen">
<span id="sec-memory-natural-numbers"></span><h4><span class="section-number">23.2.2.3. </span>Natürliche Zahlen<a class="headerlink" href="#naturliche-zahlen" title="Link zu dieser Überschrift">¶</a></h4>
<p>Wenn wir für Zahlen ebenfalls nur zwei Speicherbereiche (Datentyp und Wert) vorsehen, schränken wir uns zu sehr ein.
Denn dann ist die größte Zahl die wir darstellen können die 255.</p>
<div class="exercise admonition" id="memory-whole-numbers-computer-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.5 </span> (Ganze Zahlen auf Ihrem Computer)</p>
<div class="section" id="exercise-content">
<p>Finden Sie heraus was die größte natürliche Zahl ist, die Ihr Computer (in Form eines primitiven Datentyps) abspeichern kann.</p>
</div>
</div>
<p>Wir legen fest, dass drei Speicherbereiche (einen für den Datentyp und zwei für den Wert) ausreichen.
Das ist natürlich eine willkürliche Festlegung, für den Computer hat die Einschränkung hardwaretechnische Gründe.</p>
<div class="exercise admonition" id="memory-biggest-number-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.6 </span> (Ganze Zahlen auf dem Computer)</p>
<div class="section" id="exercise-content">
<p>Wie lautet die größte <strong>natürliche Zahl</strong> (nur der Wert), welche wir mit zwei Speicherbereichen also 2 Byte darstellen können?</p>
</div>
</div>
<div class="solution dropdown admonition" id="memory-biggest-number-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-biggest-number-exercise"> Exercise 23.6 (Ganze Zahlen auf dem Computer)</a></p>
<div class="section" id="solution-content">
<div class="math notranslate nohighlight">
\[
256 \cdot 256 - 1 = 65535 
\]</div>
</div>
</div>
<p>Sollte jede Zahl zwei Speicherbereiche belegen?
Wäre es nicht sinnvoll für kleine Zahlen lediglich einen Speicherbereich zu verwenden?
Die Antwort hierfür lautet ja und nein.
Das Ja ist offensichtlich: Wir sparen uns Speicher.
Das Nein werden Sie gleich verstehen, wenn wir den Datentyp der Liste besprechen.</p>
<p>In der Realität führt man weitere Datentypen ein, z.B., gibt es in <code class="docutils literal notranslate"><span class="pre">Java</span></code> die folgenden Datentypen für ganze Zahlen:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">long</span></code>: 64-bit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">int</span></code>: 32-bit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">short</span></code>: 16-bit</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">byte</span></code>: 8-bit</p></li>
</ul>
<p>In <code class="docutils literal notranslate"><span class="pre">Python</span></code> wird uns diese Entscheidung abgenommen bzw. werden ganze Zahlen so realisiert, dass es keine harte Grenze gibt!
Wie dies funktionieren kann werden Sie vielleicht auch verstehen, wenn wir die Listen-Realisierung besprechen.</p>
<p>Was passiert eigentlich wenn wir den Bereich der Darstellbarkeit überschreiten?</p>
<div class="exercise admonition" id="memory-overflow-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.7 </span> (Überlauf von ganzen Zahlen)</p>
<div class="section" id="exercise-content">
<p>Welcher Wert steht nach der Ausführung folgender <code class="docutils literal notranslate"><span class="pre">Java</span></code>-Codezeilen in der Variable <code class="docutils literal notranslate"><span class="pre">z</span></code>?
Sie können den Code zum Beispiel <a class="reference external" href="https://www.learnjavaonline.org/">hier</a> ausführen.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kt">byte</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">127</span><span class="p">;</span><span class="w"></span>
<span class="kt">byte</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"></span>
<span class="kt">byte</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">byte</span><span class="p">)(</span><span class="n">x</span><span class="o">+</span><span class="n">y</span><span class="p">);</span><span class="w"></span>
<span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">z</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="solution dropdown admonition" id="memory-overflow-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-overflow-exercise"> Exercise 23.7 (Überlauf von ganzen Zahlen)</a></p>
<div class="section" id="solution-content">
<p><code class="docutils literal notranslate"><span class="pre">z</span></code> enthält den Wert -128.</p>
<p>Da ein <code class="docutils literal notranslate"><span class="pre">byte</span></code> (eine 8 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a>) ganze Zahle statt natürliche Zahl repräsentiert, wird das höchste <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> als negativer Anteil interpretiert, siehe Abschnitt <a class="reference internal" href="../02-1/2-representation.html#sec-integers"><span class="std std-ref">Ganze Zahlen</span></a> Gleichung <a class="reference internal" href="../02-1/2-representation.html#equation-eq-binary-integer">(7.4)</a>.</p>
<p>Ist dieses <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> gleich <span class="math notranslate nohighlight">\(1\)</span>, so ist die Zahl negativ.
Ist das <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> dagegen <span class="math notranslate nohighlight">\(0\)</span>, so ist die Zahl positiv.</p>
<p>Da wir <span class="math notranslate nohighlight">\(8\)</span> Bits verwenden ist <span class="math notranslate nohighlight">\(127_{10} = 0111 1111_2\)</span> und <span class="math notranslate nohighlight">\(1_{10} = 0000 0001_2\)</span>.
Demnach gilt:</p>
<div class="math notranslate nohighlight">
\[0111 1111_2 + 0000 0001_2 = 1000 0000_2.\]</div>
<p>Was wiederum nach Gleichung <a class="reference internal" href="../02-1/2-representation.html#equation-eq-binary-integer">(7.4)</a></p>
<div class="math notranslate nohighlight">
\[1 \cdot (-2^8) + 0 \cdot 2^7 + \ldots + 0 \cdot 2^0 = -2^8 = -128\]</div>
<p>ergibt. Es kommt zu einem <strong>unerwünschten Überlauf</strong> (engl. <em>overflow</em>).</p>
</div>
</div>
<div class="remark admonition" id="remark-python-overflow">
<p class="admonition-title">Überlauf in Python</p>
<p>In <code class="docutils literal notranslate"><span class="pre">Python</span></code> haben Fließkommazahlen <code class="docutils literal notranslate"><span class="pre">float</span></code> ein hartes Limit, ganze Zahlen <code class="docutils literal notranslate"><span class="pre">int</span></code> jedoch nicht.</p>
<p>Ganze Zahlen <code class="docutils literal notranslate"><span class="pre">int</span></code> sind als sogenannte <strong>long integer objects</strong> implementiert, welche keine harte Grenze haben und damit zu keinem <em>Überlauf</em> führen.</p>
<p>Ganze Zahlen sind in <code class="docutils literal notranslate"><span class="pre">Python</span></code> keine <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitiven Datentypen</span></a>.</p>
</div>
</div>
<div class="section" id="speicheradressen">
<span id="sec-memory-address"></span><h4><span class="section-number">23.2.2.4. </span>Speicheradressen<a class="headerlink" href="#speicheradressen" title="Link zu dieser Überschrift">¶</a></h4>
<p>Weshalb benötigen wir Speicheradressen als gesonderten Datentyp?</p>
<p>Wir klammern bei unserer Modellierung Anweisungen aus.
Doch angenommen wir hätten derartige Anweisungen, dann würde, zum Beispiel, eine Addition darin bestehen die arithmetische Einheit der <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> anzuweisen zwei Zahlen, welche sich an einer bestimmten Speicheradresse befinden, zu addieren und das Ergebnis wieder an eine neue Speicheradresse zu schreiben.
Da diese Anweisungen selbst im <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> liegen, müssen auch die Speicheradresse im <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeicher</span></a> liegen.</p>
<p>Ein weiterer Grund erschließt sich, wenn wir den Datentyp der Liste besprechen.
Überlegen Sie vielleicht schon einmal was wir durch eine Liste von Speicheradressen erzielen könnten?</p>
<p>Die Speicheradresse ist, wie erwähnt, nichts weiter als eine natürliche Zahl.
Angenommen unser Speicher besteht aus <span class="math notranslate nohighlight">\(n\)</span> Byte.
Um jeden Speicherbereich (jedes Byte) adressieren zu können müssen wir Zahlen von <span class="math notranslate nohighlight">\(0\)</span> bis <span class="math notranslate nohighlight">\(n-1\)</span> darstellen können.
Damit ist die größtmögliche Speicheradresse eine harte Grenze für die Menge an Speicher!</p>
<p>Wir einigen uns, identisch zu den natürlichen Zahlen, auf einen <em>Adressraum</em> von 2 Byte.</p>
<div class="exercise admonition" id="memory-adress-space-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.8 </span> (Adressraum)</p>
<div class="section" id="exercise-content">
<ol class="simple">
<li><p>Wie groß kann unser Speicher sein, wenn wir 2 Byte für die Adressierung verwenden?</p></li>
<li><p>Recherchieren Sie wie groß der Adressraum Ihres Computers ist.</p></li>
</ol>
</div>
</div>
<div class="solution dropdown admonition" id="memory-adress-space-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-adress-space-exercise"> Exercise 23.8 (Adressraum)</a></p>
<div class="section" id="solution-content">
<ol class="simple">
<li><p>Wir können <span class="math notranslate nohighlight">\(2^{16} = 2^6 \cdot 2^{10} = 65536\)</span> Byte also 64 KibiByte (KB) adressieren.</p></li>
<li><p>Auf einem 32-bit System können wir <span class="math notranslate nohighlight">\(2^{32} = 2^2 \cdot 2^{30}\)</span> Byte also 4 (GB) adressieren. Wenn Ihr Computer mehr als 4 GB Arbeitsspeicher hat befinden Sie sich auf einem 64-bit System. Auf einem 64-bit System könne wir <span class="math notranslate nohighlight">\(2^{64} = 2^{34} \cdot 2^{30}\)</span> also <span class="math notranslate nohighlight">\(2^{34}\)</span> (GB), das sind <span class="math notranslate nohighlight">\(2^4 = 16\)</span> ExiByte (EB) adressieren.</p></li>
</ol>
</div>
</div>
</div>
<div class="section" id="listen">
<span id="sec-memory-list"></span><h4><span class="section-number">23.2.2.5. </span>Listen<a class="headerlink" href="#listen" title="Link zu dieser Überschrift">¶</a></h4>
<p>Die wesentliche Eigenschaft einer Liste (wie auch des <a class="reference internal" href="../02-1/4-information-flow.html#def-main-memory"><span class="std std-ref">Arbeitsspeichers</span></a>) ist, die schnelle Adressierung bei bekannter Adresse.
Kennen wir den Index <code class="docutils literal notranslate"><span class="pre">i</span></code> eines Wertes, so können wir auf den Wert in konstanter Laufzeit <span class="math notranslate nohighlight">\(\mathcal{O}(1)\)</span> zugreifen.</p>
<p>Wenn wir wissen, dass die Liste an einer bestimmten Speicheradresse <code class="docutils literal notranslate"><span class="pre">j</span></code> in unserem Arbeitsspeicher <code class="docutils literal notranslate"><span class="pre">memory</span></code> beginnt, welche Informationen benötigen wir um schnell auf das <code class="docutils literal notranslate"><span class="pre">i</span></code>-te Element der Liste zuzugreifen?
Falls jedes Element <strong>gleich viel</strong> Speicher einnimmt ist die Sache ganz einfach:
Wir müssen nur wissen wie viel Speicher jedes Element verbraucht!</p>
<p>Wenn eine Liste Elemente des <strong>gleichen</strong> Datentyps enthält, müssen wir den Datentyp auch nur einmal an den Anfang der Liste packen.
Die Elemente selbst brauchen keine Information über ihren Datentyp!</p>
<p>Was noch fehlt ist die Länge der Liste.
Diese sollten wir mit abspeichern um testen zu können ob ein Index <code class="docutils literal notranslate"><span class="pre">i</span></code> überhaupt noch im Speicherbereich der Liste liegt.
Was ist diese Länge?
Sie ist eine natürliche Zahl!
Auch hier können wir uns den Datentyp schenken, da wir impliziert wissen, dass es eine natürliche Zahl ist!</p>
<p>Fassen wir zusammen: Unsere Liste beginnt mit dem Datentyp <code class="docutils literal notranslate"><span class="pre">2</span></code> (Liste) welcher 8 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> belegt.
Es folgt die Länge der Liste als natürlichen Zahl ohne Datentypinformation.
Das sind weitere 16 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> für den Wert.
Dann folgt der Datentyp der Listenelemente, was nochmals 8 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Bit</span></a> sind.
Nach dieser Prämisse folgen die eigentlichen Elemente ohne Datentypinformation.</p>
<p><a class="reference internal" href="#fig-datatypes-in-memory"><span class="std std-numref">Abbildung 23.4</span></a> fasst alle besprochenen Datentypen zusammen.</p>
<div class="figure align-default" id="fig-datatypes-in-memory">
<a class="reference internal image-reference" href="../../_images/datatypes-in-memory.png"><img alt="../../_images/datatypes-in-memory.png" src="../../_images/datatypes-in-memory.png" style="width: 500px;" /></a>
<p class="caption"><span class="caption-number">Abb. 23.4 </span><span class="caption-text">Speicheranordnung von Werten verschiedener Datentypen. Die Liste ist eine Liste aus natürlichen Zahlen.</span><a class="headerlink" href="#fig-datatypes-in-memory" title="Link zu diesem Bild">¶</a></p>
</div>
<div class="exercise admonition" id="memory-list-addressing-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.9 </span> (Listen-Adressierung)</p>
<div class="section" id="exercise-content">
<ol class="simple">
<li><p>Angenommen jedes Listen-Element belegt 2 Speicherbereiche (2 <a class="reference internal" href="../02-1/2-representation.html#def-bit"><span class="std std-ref">Byte</span></a>) und die Liste beginnt am Index <code class="docutils literal notranslate"><span class="pre">j</span></code> in <code class="docutils literal notranslate"><span class="pre">memory</span></code>.
Wie lautet dann der Index von <code class="docutils literal notranslate"><span class="pre">memory</span></code> des <code class="docutils literal notranslate"><span class="pre">i</span></code>-ten Elements der Liste?</p></li>
<li><p>Wie viele Elemente kann eine Liste in unserem Fall maximal enthalten?</p></li>
</ol>
</div>
</div>
<div class="solution dropdown admonition" id="memory-list-addressing-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-list-addressing-exercise"> Exercise 23.9 (Listen-Adressierung)</a></p>
<div class="section" id="solution-content">
<ol class="simple">
<li><p>Auf das gesuchte Element greifen wir durch <code class="docutils literal notranslate"><span class="pre">memory[4</span> <span class="pre">+</span> <span class="pre">j</span> <span class="pre">+</span> <span class="pre">i</span> <span class="pre">*</span> <span class="pre">2]</span></code> zu.</p></li>
<li><p>Die größte natürliche Zahl, die wir abspeichern können ist eine harte Grenze für die Länge der Liste, d.h., <span class="math notranslate nohighlight">\(2^{16}-1\)</span> Elemente.</p></li>
</ol>
</div>
</div>
<p>Die schnelle und einfache Indexberechnung ist der Grund weshalb jedes Element eines <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitive Datentyps</span></a> gleich viel Speicher verbraucht.
Dies ist ein ganz wesentliches Prinzip aller modernen Computer!
Es vereinfacht bzw. beschleunigt die Adressierung.</p>
<div class="exercise admonition" id="memory-list-variable-memory-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.10 </span> (Primitive Datentypen mit variablem Speicherverbrauch)</p>
<div class="section" id="exercise-content">
<p>Angenommen wir hätten einen variablen Speicherverbrauch, d.h. kleinere Zahlen belegen weniger Speicher als große Zahlen.
Wie müssten wir dann unsere Liste realisieren?</p>
</div>
</div>
<div class="solution dropdown admonition" id="memory-list-variable-memory-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-list-variable-memory-exercise"> Exercise 23.10 (Primitive Datentypen mit variablem Speicherverbrauch)</a></p>
<div class="section" id="solution-content">
<p>Vor dem Wert der Zahl müsste deren Speicherbedarf stehen, also in unserem Beispiel ob die Zahl einen oder zwei Speicherbereiche belegt.</p>
<p>Da Zahlen unterschiedlich viele Speicherbereiche belegen, haben wir keine Möglichkeit durch die Adressen der Liste und dem Index des gesuchten Elements, auf dieses direkt zuzugreifen.</p>
<p>Das heißt, wir müssten die Liste von vorne nach hinten durchgehen bis wir am entsprechenden Index angelangt sind.</p>
</div>
</div>
<p>Aber moment!
In <code class="docutils literal notranslate"><span class="pre">Python</span></code> kann eine Liste unterschiedliche Datentypen enthalten.
Niemand verbietet mir z.B. folgende Liste zu definieren:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mf">3.4131</span><span class="p">]</span>
<span class="n">mylist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, &#39;A&#39;, &#39;B&#39;, 3, 3.4131]
</pre></div>
</div>
</div>
</div>
<p>Wie funktioniert das denn?
Bleiben Sie geduldig, auch das klären wir noch.</p>
</div>
</div>
</div>
<div class="section" id="implementierung">
<h2><span class="section-number">23.3. </span>Implementierung<a class="headerlink" href="#implementierung" title="Link zu dieser Überschrift">¶</a></h2>
<div class="section" id="speicher-initialisieren">
<h3><span class="section-number">23.3.1. </span>Speicher initialisieren<a class="headerlink" href="#speicher-initialisieren" title="Link zu dieser Überschrift">¶</a></h3>
<p>Realisieren wir zunächst einmal die Initialisierung.</p>
<div class="exercise admonition" id="memory-initialization-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.11 </span> (Speicherinitialisierung)</p>
<div class="section" id="exercise-content">
<p>Schreiben Sie eine Funktion <code class="docutils literal notranslate"><span class="pre">initialize(n)</span></code>, die einen <code class="docutils literal notranslate"><span class="pre">n-byte</span></code> Speicher initialisiert.
Initialisieren Sie einen Speicher mit 1024 Byte.
Die Funktion soll zwei Listen <code class="docutils literal notranslate"><span class="pre">memory</span></code> und <code class="docutils literal notranslate"><span class="pre">inuse</span></code> zurückgeben.</p>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="n">inuse</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span>

<span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;meomry = </span><span class="si">{</span><span class="n">memory</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;inuse = </span><span class="si">{</span><span class="n">inuse</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>meomry = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
inuse = [False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False, False]
</pre></div>
</div>
</div>
</div>
<p>Um mit dem Speicher hantieren zu können brauchen wir einige Hilfsfunktionen.
Wir tasten uns im Folgenden in ganz kleinen Schritten nach vorne.</p>
<div class="exercise admonition" id="memory-helpers-1-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.12 </span> (Valider Speicherbereich?)</p>
<div class="section" id="exercise-content">
<p>Schreiben Sie folgende Hilfsfunktionen:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">is_valid(addr,</span> <span class="pre">memory)</span></code>: Prüft ob eine Speicheradresse <code class="docutils literal notranslate"><span class="pre">addr</span></code> im Speicherbereich liegt.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_free(addr,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>: Prüft ob eine Speicheradresse nutzbar ist (valide und frei).</p></li>
</ul>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">addr</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">addr</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">memory</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">is_free</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">inuse</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="speicherverwaltung-fur-primitive-datentypen">
<h3><span class="section-number">23.3.2. </span>Speicherverwaltung für primitive Datentypen<a class="headerlink" href="#speicherverwaltung-fur-primitive-datentypen" title="Link zu dieser Überschrift">¶</a></h3>
<p>Stellen Sie sich vor wir haben wild und durcheinander in unserem Speicher geschrieben und möchten nun erneut in den Speicher etwas schreiben.
Wir müssten uns merken welche Speicherbereiche bereits belegt sind.
Das ist nicht gerade praktikabel.
Wie wäre es stattdessen wenn wir diese Aufgabe einer Funktion überlassen!
Dieser sagen wir wie viel Speicher wir gerne hätten und sie gibt uns eine entsprechende Speicheradresse zurück und setzt den benötigten Speicher auf <code class="docutils literal notranslate"><span class="pre">inuse</span></code> (Allokation).</p>
<p>Auch wäre es praktisch eine Art Umkehrfunktion dieser Operation zu haben.
Also eine Funktion die den Speicher an einer bestimmten Adresse wieder freigibt.</p>
<div class="exercise admonition" id="memory-malloc-free-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.13 </span> (Speicher statisch allokieren)</p>
<div class="section" id="exercise-content">
<p>Schreiben Sie folgende Funktionen:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">malloc(n_bytes,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>: Liefert eine Adresse <code class="docutils literal notranslate"><span class="pre">addr</span></code> zurück, die auf einen neu allokierten Speicher von <code class="docutils literal notranslate"><span class="pre">n_bytes</span></code> Bytes zeigt.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mfree(addr,</span> <span class="pre">n_bytes,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>: Gibt <code class="docutils literal notranslate"><span class="pre">n_bytes</span></code> Bytes Speicher an der Adresse <code class="docutils literal notranslate"><span class="pre">addr</span></code> frei.</p></li>
</ul>
</div>
</div>
<p>Da wir ständig mit Adressen, also natürlichen Zahlen hantieren, definieren wir uns zwei negative Zahlen, welche uns Auskunft über Erfolg oder Misserfolg der Operation geben sollen.
Immer dann wenn eine Funktion eine Adresse zurückliefert, jedoch etwas schief gegangen ist, geben wir <code class="docutils literal notranslate"><span class="pre">ERROR_CODE</span></code> anstatt der Adresse zurück.
Zum Beispiel könnte das der Fall sein, wenn der gesamte Speicher schon reserviert/allokiert wurde und wir noch mehr Speicher anfordern.</p>
<p><code class="docutils literal notranslate"><span class="pre">malloc</span></code> geht von vorne bis hinten durch den Speicher durch und sucht nach genügend zusammenhängenden freien <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Bytes</span></a>.
Das ist nicht sonderlich effektiv aber für unsere Zwecke ausreichend.
Nachdem diese zusammenhängenden <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Bytes</span></a> gefunden wurden, setzten wir deren Markierung auf <strong>allokiert</strong> bzw. auf <strong>in Benutzung</strong>, d.h., <code class="docutils literal notranslate"><span class="pre">inuse[i]</span> <span class="pre">=</span> <span class="pre">True</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">mfree</span></code> verändert nur die Markierungen und setzt diese auf <strong>frei</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ERROR_CODE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<span class="n">SUCCESS_CODE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">unfree</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
            <span class="n">inuse</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ERROR_CODE</span>
    <span class="k">return</span> <span class="n">SUCCESS_CODE</span>

<span class="k">def</span> <span class="nf">malloc</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">inuse</span><span class="p">:</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span>
            <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">addr</span> <span class="o">+=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">n_bytes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">unfree</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">addr</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">ERROR_CODE</span>
    <span class="c1"># return error code!</span>
    <span class="k">return</span> <span class="n">ERROR_CODE</span> 

<span class="k">def</span> <span class="nf">mfree</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="o">+</span><span class="n">i</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
            <span class="n">inuse</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">ERROR_CODE</span>
    <span class="k">return</span> <span class="n">SUCCESS_CODE</span>
</pre></div>
</div>
</div>
</div>
<p>Lassen Sie uns das doch einmal austesten:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">malloc</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>   <span class="c1"># 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">malloc</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>  <span class="c1"># 0 + 8 = 8</span>
<span class="nb">print</span><span class="p">(</span><span class="n">malloc</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>   <span class="c1"># 8 + 15 = 23</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mfree</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span> <span class="c1"># free bytes 0,1,...,7</span>
<span class="nb">print</span><span class="p">(</span><span class="n">malloc</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>   <span class="c1"># allocate bytes 0,1,...,7 again =&gt; 0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
8
23
-2
0
</pre></div>
</div>
</div>
</div>
<p>Bringen wir für die Allokierung und Deallokierung (Speicher freigeben) die Datentypen ins Spiel.
Wäre es nicht äußerst praktikabel Code in der folgenden Art schreiben zu können:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">data_type</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>   <span class="c1"># x = 50</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">data_type</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> <span class="c1"># y = 1000</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>                        <span class="c1"># z = x + y</span>
<span class="n">free</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">free</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>Dieser Code allokiert zwei Speicherbereiche für jeweils eine natürliche Zahl und initialisiert diese mit 50 bzw. 1000.
Dann addieren wir die zwei Zahlen die im Speicher an der Adresse <code class="docutils literal notranslate"><span class="pre">x</span></code> und <code class="docutils literal notranslate"><span class="pre">y</span></code> stehen und schreiben das Ergebnis nach <code class="docutils literal notranslate"><span class="pre">z</span></code>, wobei <code class="docutils literal notranslate"><span class="pre">z</span></code> automatisch reserviert wird.
Schlussendlich geben wir die beiden Speicherbereiche bei <code class="docutils literal notranslate"><span class="pre">x</span></code> und <code class="docutils literal notranslate"><span class="pre">y</span></code> frei.</p>
<p>Dieser Code sieht fast schon so aus wie unser üblicher <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Code.
Das verwundert nicht denn hinter einer Zuweisung</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">50</span>
</pre></div>
</div>
</div>
</div>
<p>steckt eine Speicherallokation und eine <strong>Variable</strong> <code class="docutils literal notranslate"><span class="pre">x</span></code> ist nichts anderes als ein <strong>Zeiger</strong>, d.h. eine <strong>Speicheradresse</strong> die auf den Speicherbereich zeigt, der den Wert <code class="docutils literal notranslate"><span class="pre">50</span></code> enthält.
<code class="docutils literal notranslate"><span class="pre">Python</span></code> und andere Hochsprachen nehmen uns diese Speicherorganisation ab.
Wir müssen Speicher auch nicht freigeben, auch darum kümmert sich <code class="docutils literal notranslate"><span class="pre">Python</span></code> automatisch.</p>
<p>Die Funktion <code class="docutils literal notranslate"><span class="pre">free(addr)</span></code> ist nicht ganz leicht zu implementieren, denn wir müssen anhand des Datentyps an der Speicheradresse <code class="docutils literal notranslate"><span class="pre">addr</span></code> feststellen wie viel <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Bytes</span></a> wir freigeben müssen.
Das ist für Listen besonders trickreich.
Lassen wir Listen deshalb zunächst außer acht.</p>
<div class="exercise admonition" id="memory-alloc-free-without-list-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.14 </span> (Speicher dynamisch allokieren)</p>
<div class="section" id="exercise-content">
<p>Schreiben Sie zunächst folgende einfache Hilfsfunktionen:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">number_to_byte(number)</span></code>: Wandelt eine natürliche Zahl in 2 <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Bytes</span></a> um.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_number(byte1,</span> <span class="pre">byte2)</span></code>: Wandelt 2 <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Bytes</span></a> in eine natürliche Zahl um.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">char_to_byte(char)</span></code>: Wandelt ein Zeichen in ein <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Byte</span></a>  um.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">to_char(byte)</span></code>: Wandelt ein <a class="reference internal" href="../02-1/2-representation.html#def-byte"><span class="std std-ref">Byte</span></a> in ein Zeichen um.</p></li>
</ul>
<p>Daraufhin definieren Sie folgende Funktionen zur Speicherverwaltung:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">calc_bytes(data_type)</span></code>: Berechnet die Anzahl an Bytes, welche ein Wert vom Typ <code class="docutils literal notranslate"><span class="pre">data_type</span></code> verbraucht.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">alloc(data_type,</span> <span class="pre">value,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>: Liefert eine Adresse <code class="docutils literal notranslate"><span class="pre">addr</span></code> zurück, die auf einen neu reservierten Speicher zeigt und schreibt den Wert <code class="docutils literal notranslate"><span class="pre">value</span></code> gleich an die richtige Stelle.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">free(addr,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>: Gibt den Speicher an <code class="docutils literal notranslate"><span class="pre">addr</span></code> frei.</p></li>
</ul>
<p><strong>Hinweis:</strong> Lassen Sie Listen in diesem Schritt außer acht, um diese kümmern wir uns gleich. <code class="docutils literal notranslate"><span class="pre">free</span></code> enthält keine Informationen darüber wie viel Speicher freigegeben wird. Diese Information erhalten Sie durch die Datentypen, also durch <code class="docutils literal notranslate"><span class="pre">calc_bytes</span></code>.</p>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">name_to_data_type</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;addr&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

<span class="k">def</span> <span class="nf">to_data_type</span><span class="p">(</span><span class="n">name</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">name_to_data_type</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name_to_data_type</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ERROR_CODE</span>

<span class="k">def</span> <span class="nf">number_to_byte</span><span class="p">(</span><span class="n">number</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">number</span> <span class="o">//</span> <span class="mi">256</span><span class="p">,</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">to_number</span><span class="p">(</span><span class="n">byte1</span><span class="p">,</span> <span class="n">byte2</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">byte1</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">+</span> <span class="n">byte2</span>

<span class="k">def</span> <span class="nf">char_to_byte</span><span class="p">(</span><span class="n">char</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">to_char</span><span class="p">(</span><span class="n">byte</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="mi">3</span>
    <span class="k">return</span> <span class="n">ERROR_CODE</span>

<span class="k">def</span> <span class="nf">alloc</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">n_bytes</span> <span class="o">=</span> <span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">n_bytes</span> <span class="o">==</span> <span class="n">ERROR_CODE</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ERROR_CODE</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">addr</span> <span class="o">!=</span> <span class="n">ERROR_CODE</span><span class="p">:</span>
        <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_type</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
            <span class="n">byte_value</span> <span class="o">=</span> <span class="n">number_to_byte</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
            <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">char_to_byte</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">addr</span>

<span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>
        <span class="n">n_bytes</span> <span class="o">=</span> <span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mfree</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">ERROR_CODE</span>
</pre></div>
</div>
</div>
</div>
<p>Lassen Sie uns das doch einmal austesten:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>   <span class="c1"># 0</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">130</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span> <span class="c1"># 0 + 3 = 3</span>
<span class="nb">print</span><span class="p">(</span><span class="n">to_number</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="mi">3</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">memory</span><span class="p">[</span><span class="mi">3</span><span class="o">+</span><span class="mi">2</span><span class="p">]))</span>               <span class="c1"># 130</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">),</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>   <span class="c1"># 3 + 3 = 6</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">),</span> <span class="s1">&#39;C&#39;</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>   <span class="c1"># 6 + 2 = 8</span>
<span class="nb">print</span><span class="p">(</span><span class="n">free</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>                            <span class="c1"># free bytes 0,1,...,24 =&gt; -2 == SUCCESS</span>
<span class="nb">print</span><span class="p">(</span><span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">6</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>   <span class="c1"># allocate bytes 0,1,2,3 again =&gt; 0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
3
130
6
8
-2
0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="addieren-im-speicher">
<h3><span class="section-number">23.3.3. </span>Addieren im Speicher<a class="headerlink" href="#addieren-im-speicher" title="Link zu dieser Überschrift">¶</a></h3>
<p>Um zwei Zahlen im Speicher zu addieren fehlt uns nur noch eine Funktion die zwei Zahlen an zwei Speicheradressen liest und das Ergebnis der Addition an eine neu reservierte Speicheradresse schreibt.
Diese neue Adresse sollte die Funktion zurückgeben.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_number</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">to_number</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">addr1</span><span class="p">,</span> <span class="n">addr2</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">number1</span> <span class="o">=</span> <span class="n">read_number</span><span class="p">(</span><span class="n">addr1</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span>
    <span class="n">number2</span> <span class="o">=</span> <span class="n">read_number</span><span class="p">(</span><span class="n">addr2</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span>

    <span class="c1"># % (256**2) erzeugt den Überfluss (Overflow) falls die Zahlen zu groß werden!</span>
    <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">number1</span> <span class="o">+</span> <span class="n">number2</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">256</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="n">value</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">addr</span>
</pre></div>
</div>
</div>
</div>
<p>Lassen Sie uns nun endlich die Addition über unseren Speicher durchführen:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>                       <span class="c1"># fresh memory</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">50</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>   <span class="c1"># x = 50</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span> <span class="c1"># y = 1000</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>                           <span class="c1"># z = x + y</span>
<span class="n">free</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">free</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">read_number</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">memory</span><span class="p">))</span>                          <span class="c1"># 1050</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1050
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="speicherverwaltung-fur-listen">
<h3><span class="section-number">23.3.4. </span>Speicherverwaltung für Listen<a class="headerlink" href="#speicherverwaltung-fur-listen" title="Link zu dieser Überschrift">¶</a></h3>
<p>Was fehlt ist <code class="docutils literal notranslate"><span class="pre">alloc</span></code> und <code class="docutils literal notranslate"><span class="pre">free</span></code> für eine Liste.
Was wir benötigen ist die Berechnung des Speicherbedarfs einer Liste.
Betrachten Sie <a class="reference internal" href="#fig-list-in-memory"><span class="std std-numref">Abbildung 23.5</span></a>.
Wir berechnen den Speicherbedarf einer Liste durch</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">calc_byte</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>wobei <code class="docutils literal notranslate"><span class="pre">n</span></code> die Anzahl der Listenelemente ist.
Weshalb subtrahieren wir die eins?
Da Listenelemente keine Datentypinformation benötigen!</p>
<div class="figure align-default" id="fig-list-in-memory">
<a class="reference internal image-reference" href="../../_images/list-in-memory.png"><img alt="../../_images/list-in-memory.png" src="../../_images/list-in-memory.png" style="width: 600px;" /></a>
<p class="caption"><span class="caption-number">Abb. 23.5 </span><span class="caption-text">Liste wie sie im Speicher liegt. Um den Speicherbedarf zu berechnen benötigen wir die <strong>Länge der Liste</strong>, und den <strong>Datentyp der Listenelemente</strong>.</span><a class="headerlink" href="#fig-list-in-memory" title="Link zu diesem Bild">¶</a></p>
</div>
<div class="exercise admonition" id="memory-alloc-list-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.15 </span> (Speicher für Listen allokieren)</p>
<div class="section" id="exercise-content">
<p>Schreiben Sie eine Funktion <code class="docutils literal notranslate"><span class="pre">calc_list_bytes(addr,</span> <span class="pre">memory)</span></code>, welche den benötigten Speicherbereich einer Liste, welche an Adresse <code class="docutils literal notranslate"><span class="pre">addr</span></code> startet, berechnet.
Bauen Sie diese Funktion in <code class="docutils literal notranslate"><span class="pre">free</span></code> ein.</p>
<p>Schreiben Sie eine weitere Funktion <code class="docutils literal notranslate"><span class="pre">alloc_list(data_type,</span> <span class="pre">n,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code> die Speicher für eine Liste reserviert, wobei <code class="docutils literal notranslate"><span class="pre">data_type</span></code> der Datentyp der Listenelemente und <code class="docutils literal notranslate"><span class="pre">n</span></code> die Anzahl der Listenelemente ist.</p>
<p><strong>Hinweis:</strong> Sie müssen die natürliche 2-byte Zahl in eine herkömmliche Dezimalzahl umwandeln. Hierfür empfiehlt sich die Hilfsfunktion <code class="docutils literal notranslate"><span class="pre">to_number(byte1,</span> <span class="pre">byte2)</span></code>.</p>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">calc_list_bytes</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">to_number</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
    <span class="n">n_bytes_element</span> <span class="o">=</span> <span class="n">calc_bytes</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="n">n_bytes_element</span>

<span class="k">def</span> <span class="nf">alloc_list</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">n_bytes</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">ERROR_CODE</span>
    
    <span class="c1"># 1. alloc memory</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">malloc</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

    <span class="c1"># 2. initalize meta data (data type of the list and its elements and length of the list)</span>
    <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
    <span class="n">n_bytes</span> <span class="o">=</span> <span class="n">number_to_byte</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
    <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_bytes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_type</span>
    <span class="k">return</span> <span class="n">addr</span>

<span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">):</span>
            <span class="n">n_bytes</span> <span class="o">=</span> <span class="n">calc_list_bytes</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_bytes</span> <span class="o">=</span> <span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mfree</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>
</pre></div>
</div>
</div>
</div>
<p>Falls wir eine Liste <strong>allokieren</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">length</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="n">alloc_list</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="n">length</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">mylist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9
</pre></div>
</div>
</div>
</div>
<p>ist diese unbefüllt und wir können mit ihr noch nichts anfangen.
Wir benötigen Funktionen für den Zugriff.</p>
<div class="exercise admonition" id="memory-access-list-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.16 </span> (Listenverwaltung)</p>
<div class="section" id="exercise-content">
<p>Schreiben Sie folgende Funktionen zur Verwaltung einer Liste:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">list_len(addr,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>: Gibt die Länge der Liste zurück.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">set_list_value(addr,</span> <span class="pre">index,</span> <span class="pre">value,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>: Setzt den Wert <code class="docutils literal notranslate"><span class="pre">value</span></code> an die Position <code class="docutils literal notranslate"><span class="pre">index</span></code> der Liste, die an <code class="docutils literal notranslate"><span class="pre">addr</span></code> beginnt.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_list_value(addr,</span> <span class="pre">index,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>: Gibt das Listenelement an der Stelle <code class="docutils literal notranslate"><span class="pre">index</span></code> der Liste zurück.</p></li>
</ul>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">list_len</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">to_number</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">set_list_value</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">mem_addr</span> <span class="o">=</span> <span class="n">addr</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">index</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
        <span class="n">byte_value</span> <span class="o">=</span> <span class="n">number_to_byte</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">SUCCESS_CODE</span>
    <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
        <span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">char_to_byte</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">SUCCESS_CODE</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ERROR_CODE</span>
        
<span class="k">def</span> <span class="nf">get_list_value</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">data_type</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
    <span class="n">mem_addr</span> <span class="o">=</span> <span class="n">addr</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">index</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">to_number</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="p">],</span> <span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">to_char</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ERROR_CODE</span>
</pre></div>
</div>
</div>
</div>
<p>Lassen Sie uns eine Liste mit den Quadratzahlen von 1 bis einschließlich 10 erzeugen und zur Überprüfung wieder Ausgeben:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>  
<span class="n">length</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="n">alloc_list</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="n">length</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">list_len</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

<span class="c1"># fill list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
    <span class="n">set_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    
<span class="c1"># read from list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">get_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>
  
<span class="n">n_allocated_bytes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">inuse</span> <span class="k">if</span> <span class="n">e</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We allocated </span><span class="si">{</span><span class="n">n_allocated_bytes</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>         

<span class="c1"># 24 Byte (4 + 10 * 2)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Our list in mememory: </span><span class="si">{</span><span class="n">memory</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">n_allocated_bytes</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
4
9
16
25
36
49
64
81
100
We allocated 24 bytes
Our list in mememory: [2, 0, 10, 0, 0, 1, 0, 4, 0, 9, 0, 16, 0, 25, 0, 36, 0, 49, 0, 64, 0, 81, 0, 100]
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="mehrdimensionale-listen">
<h3><span class="section-number">23.3.5. </span>Mehrdimensionale Listen<a class="headerlink" href="#mehrdimensionale-listen" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wenn Sie <code class="docutils literal notranslate"><span class="pre">alloc_list</span></code> betrachten werden Sie festellen, dass eine Liste aus Elementen vom Datentyp <code class="docutils literal notranslate"><span class="pre">to_data_type('list')</span></code> nicht zulässig ist.
Unsere Liste darf derzeit nur <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitive Datentypen</span></a> (natürliche Zahlen, Zeichen und Adressen) beinhalten.</p>
<p>Mehrdimensionale Listen aus Elementen eines <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitiven Datentyps</span></a> lassen sich recht einfach erstellen, wenn wir anstatt einer Länge, für jede Dimension eine Länge anfügen.
Eine solche Liste würde anstatt einer Länge eine Liste aus Längen beinhalten.
Zudem würden wir die Elemente immernoch linear nebeneinander anordnen.</p>
<p>Nehmen wir zum Beispiel an, wir möchten eine zweidimensionale Liste erzeugen, wobei die erste Dimension die Länge <span class="math notranslate nohighlight">\(n\)</span> und die zweite die Länge <span class="math notranslate nohighlight">\(m\)</span> hat.
Die Liste <code class="docutils literal notranslate"><span class="pre">two_dim_list</span></code> enthält demnach</p>
<div class="math notranslate nohighlight">
\[n \cdot m\]</div>
<p>Elemente. Das Element <code class="docutils literal notranslate"><span class="pre">two_dim_list[i][j]</span></code> hat den linearen Index</p>
<div class="math notranslate nohighlight">
\[k = i \cdot m + j\]</div>
<p>und der lineare index <span class="math notranslate nohighlight">\(k\)</span> lässt sich wie folgt in einen zweidimensionalen Index umrechnen:</p>
<div class="math notranslate nohighlight">
\[i = \left \lfloor{k / m}\right \rfloor, j = k - i \cdot j.\]</div>
<p>Es gibt aber noch eine andere Möglichkeit mehrdimensionale Listen zu realisieren.
Diese bietet uns zugleich eine Möglichkeit Listen mit Elementen mit unterschiedlichen Datentypen zu erstellen.
Haben Sie eine Idee wie wir das erreichen können?</p>
<div class="exercise admonition" id="memory-list-pointer-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.17 </span> (Listen und Zeiger)</p>
<div class="section" id="exercise-content">
<p>Wie können wir Listen mit Elementen mit unterschiedlichen Datentypen realisieren?</p>
<p><strong>Tipp:</strong> Denken Sie an den Datentyp, den wir bis jetzt noch gar nicht verwendet haben.</p>
</div>
</div>
<div class="solution dropdown admonition" id="memory-list-pointer-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-list-pointer-exercise"> Exercise 23.17 (Listen und Zeiger)</a></p>
<div class="section" id="solution-content">
<p>Wir können Adressen (Zeiger) als Listenelemente verwenden.
Diese Adressen können auf unterschiedliche <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitive Datentypen</span></a> aber auch andere Listen zeigen!</p>
</div>
</div>
<p>Folgender Code erzeugt die gleiche Ausgabe wie zuvor, doch liegen die Quadratzahlen irgendwo verteilt im Speicher <code class="docutils literal notranslate"><span class="pre">memory</span></code>.
Deren Adressen sind jedoch in der Liste enthalten.
Die Speicherverwaltung wird dadurch komplexer.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>  
<span class="n">length</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="n">alloc_list</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">),</span> <span class="n">length</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">list_len</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We allocated </span><span class="si">{</span><span class="nb">len</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">inuse</span> <span class="k">if</span> <span class="n">e</span><span class="p">])</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>

<span class="c1"># fill list with pointers</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="c1"># pointer to the number (i+1)**2</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="n">set_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    
<span class="c1"># read from list</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
    <span class="c1"># read pointer</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">get_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="c1"># read the number at the pointer</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">read_number</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">))</span>
    
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We allocated </span><span class="si">{</span><span class="nb">len</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">inuse</span> <span class="k">if</span> <span class="n">e</span><span class="p">])</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We allocated 24 bytes
1
4
9
16
25
36
49
64
81
100
We allocated 54 bytes
</pre></div>
</div>
</div>
</div>
<p>Wenn wir den gesamten Speicher wieder freigeben wollen, reicht es nicht nur den Speicher der Liste freizugeben.
Wir müssen auch den Speicher an den Adressen der Liste freigeben.
Dabei müssen wir sicher sein, dass kein anderer noch verwendeter Zeiger auf das Element zeigt!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 54 Bytes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We allocated </span><span class="si">{</span><span class="nb">len</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">inuse</span> <span class="k">if</span> <span class="n">e</span><span class="p">])</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>

<span class="c1"># deep free of the memory</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="n">addr</span> <span class="o">=</span> <span class="n">get_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="n">free</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

<span class="c1"># 24 Bytes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We allocated </span><span class="si">{</span><span class="nb">len</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">inuse</span> <span class="k">if</span> <span class="n">e</span><span class="p">])</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
<span class="n">free</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

<span class="c1"># 0 Bytes</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;We allocated </span><span class="si">{</span><span class="nb">len</span><span class="p">([</span><span class="n">e</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">inuse</span> <span class="k">if</span> <span class="n">e</span><span class="p">])</span><span class="si">}</span><span class="s2"> bytes&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>We allocated 54 bytes
We allocated 24 bytes
We allocated 0 bytes
</pre></div>
</div>
</div>
</div>
<p>All das übernimmt in <code class="docutils literal notranslate"><span class="pre">Python</span></code> der sogenannte <a class="reference internal" href="#def-garbage-collector"><span class="std std-ref">Garbage Collector</span></a>.</p>
<div class="definition admonition" id="def-garbage-collector">
<p class="admonition-title">Garbage Collector (Python)</p>
<p>Der <em>Garbage Collector</em> bezeichnet eine automatische Speicherverwaltung, die zur Vermeidung von Speicherproblemen beiträgt und zur Laufzeit nicht länger benötigte Speicherbereiche automatisch freigibt. Der Vorteil wird mit einem erhöhten Ressourcenverbrauch erkauft.</p>
</div>
</div>
<div class="section" id="ein-einfacher-parser">
<h3><span class="section-number">23.3.6. </span>Ein einfacher Parser<a class="headerlink" href="#ein-einfacher-parser" title="Link zu dieser Überschrift">¶</a></h3>
<p>Um die Manipulationen im Speicher besser nachzuvollziehen zu können wäre es großartig eine Funktion <code class="docutils literal notranslate"><span class="pre">mem_to_string(addr,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code> zu haben, welche einen <a class="reference internal" href="../03-5/4-kind-of-data-types.html#def-primitive-datatypes"><span class="std std-ref">primitiven Datentyp</span></a> oder eine <a class="reference internal" href="#sec-memory-list"><span class="std std-ref">Liste</span></a> in einer gut leserliche Zeichenkette umwandelt.</p>
<p>An einer Adresse <code class="docutils literal notranslate"><span class="pre">ADDR</span></code> kann sich eine andere <code class="docutils literal notranslate"><span class="pre">ADDR</span></code>, eine Zahl <code class="docutils literal notranslate"><span class="pre">number</span></code>, ein Zeichen <code class="docutils literal notranslate"><span class="pre">char</span></code> oder eine Liste <code class="docutils literal notranslate"><span class="pre">LIST</span></code> befinden.
Eine Liste <code class="docutils literal notranslate"><span class="pre">LIST</span></code> kann wiederum natürliche Zahlen <code class="docutils literal notranslate"><span class="pre">number</span></code>, Zeichen <code class="docutils literal notranslate"><span class="pre">char</span></code> oder Adressen <code class="docutils literal notranslate"><span class="pre">ADDR</span></code> enthalten.
Diese Struktur ist eine von uns definierte <strong>Syntax</strong>!
Was wir benötigen ist ein Programm (in unserem Fall nur eine Funktion), welche diese <strong>Syntax</strong> versteht und umwandelt – wir brauchen einen Interpreter.
Ein solches Programm nennt man <a class="reference internal" href="#def-parser"><span class="std std-ref">Parser</span></a>.</p>
<div class="definition admonition" id="def-parser">
<p class="admonition-title">Parser</p>
<p>Ein <em>Parser</em> wandelt eine Struktur (z.B. Datenstruktur oder eine Zeichenkette) in eine andere Struktur um.
Die Syntax der Quell- und Zielstruktur sind oft durch eine Grammatik definiert.</p>
</div>
<p>Um unsere <strong>Syntax</strong> zu definieren nutzten wir eine sog. Grammatik mit den folgenden Ableitungsregeln:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ADDR</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">ADDR</span> <span class="pre">|</span> <span class="pre">number</span> <span class="pre">|</span> <span class="pre">char</span> <span class="pre">|</span> <span class="pre">LIST</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LIST</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">[</span> <span class="pre">(ADDR,</span> <span class="pre">...,</span> <span class="pre">ADDR)</span> <span class="pre">|</span> <span class="pre">(number,</span> <span class="pre">...,</span> <span class="pre">number)</span> <span class="pre">|</span> <span class="pre">(char,</span> <span class="pre">...,</span> <span class="pre">char)</span> <span class="pre">]</span></code></p></li>
</ol>
<p>Das was links vom Ableitungspfeil steht, kann durch das was rechts vom Pfeil steht ersetzt werden.</p>
<p>Eine Adresse <code class="docutils literal notranslate"><span class="pre">ADDR</span></code> kann auf eine weitere Adresse <code class="docutils literal notranslate"><span class="pre">ADDR</span></code>, eine Zahl <code class="docutils literal notranslate"><span class="pre">number</span></code>, ein Zeichen <code class="docutils literal notranslate"><span class="pre">char</span></code> oder eine Liste <code class="docutils literal notranslate"><span class="pre">LIST</span></code> verweisen.
Handelt es sich um eine Zahl oder ein Zeichen, können wir dieses ausgeben.
Verweist die Adresse auf eine Adresse, springen wir zu dieser Adresse und fahren fort.
Verweist die Adresse auf eine Liste, geben wir <code class="docutils literal notranslate"><span class="pre">[</span></code> aus und iterieren durch jedes Element der Liste.
Handelt es sich bei einem Listenelement um eine Zahl oder ein Zeichen, geben wir dieses aus.
Handelt es sich um eine Adresse verfahren wir entsprechend weiter.
Nachdem wir durch eine Liste iteriert sind, geben wir <code class="docutils literal notranslate"><span class="pre">]</span></code> aus.</p>
<p>Da unsere <a class="reference internal" href="../02-1/2-interpretation.html#def-syntax"><span class="std std-ref">Syntax</span></a> rekursiv definiert ist, eignet sich auch eine <a class="reference internal" href="../03-6/x-recursion.html#sec-recursive-functions"><span class="std std-ref">rekursive Funktion</span></a> um die Ausgabe zu erzeugen.</p>
<div class="exercise admonition" id="memory-rekursive-print-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.18 </span> (Rekursive Ausgabe)</p>
<div class="section" id="exercise-content">
<p>Implementieren Sie eine Funktion <code class="docutils literal notranslate"><span class="pre">mem_to_string(addr,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>, die eine geeignete Zeichenkette des an der Adresse <code class="docutils literal notranslate"><span class="pre">addr</span></code> liegenden Elements zurückliefert.</p>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">char_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">to_char</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

<span class="k">def</span> <span class="nf">number_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">):</span>
    <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">to_number</span><span class="p">(</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">]))</span>

<span class="k">def</span> <span class="nf">list_to_str</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span>
    <span class="n">length</span> <span class="o">=</span> <span class="n">list_len</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="n">element_data_type</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="n">mylist</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
    
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">get_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">element_data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">mem_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">element_data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">value</span>
        <span class="k">elif</span> <span class="n">element_data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span>
    <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;]&quot;</span>
    <span class="k">return</span> <span class="n">output</span>
    
<span class="k">def</span> <span class="nf">mem_to_string</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span> <span class="ow">and</span> <span class="n">inuse</span><span class="p">[</span><span class="n">addr</span><span class="p">]:</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">char_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">number_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">):</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">list_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
            <span class="n">new_addr</span> <span class="o">=</span> <span class="n">read_number</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">)</span>
            <span class="n">output</span> <span class="o">+=</span> <span class="n">mem_to_string</span><span class="p">(</span><span class="n">new_addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">output</span>
</pre></div>
</div>
</div>
</div>
<p>Betrachten wir zunächst <code class="docutils literal notranslate"><span class="pre">mem_to_string</span></code>.
Für unsere natürlichen Zahlen und Zeichen ist die Sache klar.
Für Sie transformieren wir den Wert im Speicher gegeben durch <code class="docutils literal notranslate"><span class="pre">addr</span></code> in eine Zeichenkette.
Das übernehmen die Funktionen <code class="docutils literal notranslate"><span class="pre">char_to_str</span></code> und <code class="docutils literal notranslate"><span class="pre">number_to_str</span></code>.</p>
<p>Handelt es sich hingegen um eine Adresse holen wir ebenfalls den Wert der Adresse <code class="docutils literal notranslate"><span class="pre">new_addr</span></code> aus dem Speicher.
Wir sind wieder am Ausgangspunkt, d.h. wir haben erneut eine Adresse <code class="docutils literal notranslate"><span class="pre">new_addr</span></code> und möchten den Wert, der an dieser Adresse steht, in eine schön formatierte Zeichenkette umwandeln.
Demnach rufen wir <code class="docutils literal notranslate"><span class="pre">mem_to_string</span></code> mit dieser neuen Adresse <code class="docutils literal notranslate"><span class="pre">new_addr</span></code> auf.
Würde an der neuen Adresse erneut eine Adresse stehen würden wir den Vorgang wiederholen und zwar solange bis an der Adresse keine neue Adresse mehr steht.</p>
<p>Bleibt noch der Fall der Liste.
Wenn der Datentyp an der Adresse <code class="docutils literal notranslate"><span class="pre">addr</span></code> eine Liste ist, wandeln wir diese Liste durch <code class="docutils literal notranslate"><span class="pre">list_to_str</span></code> in eine Zeichenkette um.
Glücklicherweise können wir unsere zuvor definierten Hilfsfunktionen <code class="docutils literal notranslate"><span class="pre">list_len</span></code> und <code class="docutils literal notranslate"><span class="pre">get_list_value</span></code> nutzen.
Die Zeichenkette lassen wir mit einem <code class="docutils literal notranslate"><span class="pre">&quot;[&quot;</span></code> beginnen um den Anfang der Liste zu markieren.
Durch <code class="docutils literal notranslate"><span class="pre">list_len</span></code> holen wir die Längeninformation der Liste aus dem Speicher.
Anhand unserer Listendefinition in <a class="reference internal" href="#fig-list-in-memory"><span class="std std-numref">Abbildung 23.5</span></a>, wissen wir dass an <code class="docutils literal notranslate"><span class="pre">memory[mylist+3]</span></code> der Datentyp der Listenelemente der Liste steht.
Was folgt ist eine Iteration über die Listenelemente.
<code class="docutils literal notranslate"><span class="pre">get_list_value</span></code> liefert uns je ein Listenelement.
Erneut ist der Fall für die Zahlen und Zeichenketten klar.
<code class="docutils literal notranslate"><span class="pre">get_list_value</span></code> holt den Wert aus dem Speicher, diesen wandeln wir in eine Zeichenkette um.
Für eine Adresse gilt das gleiche und wir haben bereits eine Funktion die diese Aufgabe übernehmen kann.
Sie heißt <code class="docutils literal notranslate"><span class="pre">mem_to_string</span></code>!
An dieser Stelle setzten wir erneut auf die <a class="reference internal" href="../02-4/3-control-structures.html#sec-recursion"><span class="std std-ref">Rekursion</span></a>.
Wir trennen jedes Listenelement durch <code class="docutils literal notranslate"><span class="pre">&quot;,</span> <span class="pre">&quot;</span></code> und fügen am Ende noch die geschlossene Klammer <code class="docutils literal notranslate"><span class="pre">&quot;]&quot;</span></code> an, um das Ende der Liste zu markieren.</p>
<p>Die beiden rekursiven Funktionsaufrufe ergeben sich aus der beschriebenen <a class="reference internal" href="../02-1/2-interpretation.html#def-syntax"><span class="std std-ref">Syntax</span></a>.
Im ersten Fall aus</p>
<p><code class="docutils literal notranslate"><span class="pre">ADDR</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">ADDR</span></code></p>
<p>und im zweiten Fall aus</p>
<p><code class="docutils literal notranslate"><span class="pre">ADDR</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">LIST</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">(ADDR,</span> <span class="pre">...,</span> <span class="pre">ADDR)</span></code>.</p>
<p>Durch <code class="docutils literal notranslate"><span class="pre">mem_to_string</span></code> haben wir eine Möglichkeit um zu testen ob unsere definierten Funktionen auch das gewünschte Ergebnis erzeugen und unser Speicher <code class="docutils literal notranslate"><span class="pre">memory</span></code> so manipuliert wird, wie wir uns das gedacht haben.
Zum Beispiel können wir nun unsere <em>Variablen</em> durch <code class="docutils literal notranslate"><span class="pre">mem_to_string</span></code> Ausgeben:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">4</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">130</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">char1</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">),</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">char2</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">),</span> <span class="s1">&#39;B&#39;</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

<span class="c1"># 4 + 130 = 134</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span><span class="si">}</span><span class="s2"> + </span><span class="si">{</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span><span class="si">}</span><span class="s2"> = </span><span class="si">{</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># A</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">char1</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>

<span class="c1"># B</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">char2</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4 + 130 = 134
A
B
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="listen-erzeugen">
<h3><span class="section-number">23.3.7. </span>Listen erzeugen<a class="headerlink" href="#listen-erzeugen" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wie Sie oben sehen, können wir durch <code class="docutils literal notranslate"><span class="pre">alloc</span></code> bereits sehr bequem mit primitiven Datentypen umgehen.
Um eine Liste zu erstellen haben wir noch keine solche Hilfsfunktion implementiert.
Wäre es nicht toll wenn wir durch folgenden Code eine neue Liste aus Zahlen oder Zeichen an die Adresse <code class="docutils literal notranslate"><span class="pre">numbers</span></code> bzw. <code class="docutils literal notranslate"><span class="pre">chars</span></code> schreiben könnten?</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">numbers</span> <span class="o">=</span> <span class="n">new_primitive_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">chars</span> <span class="o">=</span> <span class="n">new_primitive_list</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">),</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
</pre></div>
</div>
<div class="exercise admonition" id="memory-list-generation-primitive-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.19 </span> (Listen für primitive Datentypen erzeugen)</p>
<div class="section" id="exercise-content">
<p>Implementieren Sie die Funktion <code class="docutils literal notranslate"><span class="pre">new_primitive_list(values,</span> <span class="pre">data_type,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>.
Verwenden Sie hierfür <code class="docutils literal notranslate"><span class="pre">alloc_list</span></code> und <code class="docutils literal notranslate"><span class="pre">set_list_value</span></code>.
<code class="docutils literal notranslate"><span class="pre">values</span></code> enthält die Werte der Liste, wobei diese entweder <strong>ausschließlich</strong> Zahlen oder Zeichen sind.</p>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">new_primitive_list</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">mylist</span> <span class="o">=</span> <span class="n">alloc_list</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

    <span class="c1"># fill list</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">set_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mylist</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">new_primitive_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">chars</span> <span class="o">=</span> <span class="n">new_primitive_list</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">),</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, 3, 4, 5]
[H, e, l, l, o,  , W, o, r, l, d]
</pre></div>
</div>
</div>
</div>
<p>Durch unsere Funktionen bauen wir an einer Welt, welche wir immer besser manipulieren können.
Gehen wir noch einen Schritt weiter!
Wäre es nicht wundervoll, wenn folgender Code funktionieren würde:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">new_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;Hello World&quot;</span><span class="p">],</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
</pre></div>
</div>
<div class="exercise admonition" id="memory-list-generation-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.20 </span> (Listen erzeugen)</p>
<div class="section" id="exercise-content">
<p>Implementieren Sie die gewünschte Funktion <code class="docutils literal notranslate"><span class="pre">new_list(values,</span> <span class="pre">memory,</span> <span class="pre">inuse)</span></code>.
Sie müssen dabei für jeden Eintrag in <code class="docutils literal notranslate"><span class="pre">values</span></code> den Datentyp berechnen.
Verwenden Sie <code class="docutils literal notranslate"><span class="pre">alloc_list</span></code>, <code class="docutils literal notranslate"><span class="pre">alloc</span></code> und <code class="docutils literal notranslate"><span class="pre">set_list_value</span></code>.</p>
<p><strong>Hinweise:</strong></p>
<ol class="simple">
<li><p>Da Ihre Liste weitere Listen enthalten kann werden Sie vermutlich auf die Rekursion zurückgreifen müssen.</p></li>
<li><p>Da Ihre Listen gemischte Datentypen enthalten, sollten Sie Zeiger / Adressen verwenden.</p></li>
</ol>
</div>
</div>
<p>Wir haben eine kleine Hilfsfunktion <code class="docutils literal notranslate"><span class="pre">get_data_type(value)</span></code> geschrieben, die uns den Datentyp anhand des Wertes <code class="docutils literal notranslate"><span class="pre">value</span></code> bestimmt.
Wichtig dabei ist, dass eine Zeichenkette mit Länge gleich 1 ein <code class="docutils literal notranslate"><span class="pre">char</span></code> ist, wobei eine Zeichenkette mit Länger &gt; 1 eine Liste (aus <code class="docutils literal notranslate"><span class="pre">char</span></code>) ist!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">get_data_type</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">new_list</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">):</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="n">mylist</span> <span class="o">=</span> <span class="n">alloc_list</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">),</span> <span class="n">length</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="n">element_data_type</span> <span class="o">=</span> <span class="n">get_data_type</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">element_data_type</span> <span class="ow">in</span> <span class="p">[</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">)]:</span>
            <span class="n">addr</span> <span class="o">=</span> <span class="n">alloc</span><span class="p">(</span><span class="n">element_data_type</span><span class="p">,</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">addr</span> <span class="o">=</span> <span class="n">new_list</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
        <span class="n">set_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">mylist</span>

<span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">new_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="n">chars</span> <span class="o">=</span> <span class="n">new_list</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

<span class="c1"># [1, 2, [H, e, l, l, o,  , W, o, r, l, d], 4, 5]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">numbers</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>

<span class="c1"># [H, e, l, l, o,  , W, o, r, l, d]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">chars</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>

<span class="n">mylist</span> <span class="o">=</span> <span class="n">new_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;Hello World&quot;</span><span class="p">],</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>

<span class="c1"># [1, 2, A, [[1, 2], 3, 4], [H, e, l, l, o,  , W, o, r, l, d]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, [H, e, l, l, o,  , W, o, r, l, d], 4, 5]
[H, e, l, l, o,  , W, o, r, l, d]
[1, 2, A, [[1, 2], 3, 4], [H, e, l, l, o,  , W, o, r, l, d]]
</pre></div>
</div>
</div>
</div>
<p>Durch unsere zuvor definierten Hilfsfunktionen ist <code class="docutils literal notranslate"><span class="pre">new_list</span></code> zwar immernoch eine Herausforderung aber stellen Sie sich einmal vor wir hätten keine der Hilfsfunktionen zuvor definiert.
Die <strong>Dekomposition</strong> des Problems in viele kleinere Probleme hilft uns ungemein beim Lösen des Gesamtproblems.</p>
</div>
<div class="section" id="ende-der-reise">
<h3><span class="section-number">23.3.8. </span>Ende der Reise<a class="headerlink" href="#ende-der-reise" title="Link zu dieser Überschrift">¶</a></h3>
<p>An dieser Stelle beenden wir die Reise.
Sie können ihren Code selbständig gerne um weitere Funktionen erweitern.</p>
<p>Wie wäre es zum Beispiel mit der Subtraktion von zwei Zahlen <span class="math notranslate nohighlight">\(a - b\)</span>?
Was machen Sie wenn <span class="math notranslate nohighlight">\(b &gt; a\)</span> ist?
Oder wie wäre es mit der Implementierung der <code class="docutils literal notranslate"><span class="pre">Python</span></code>-ähnlichen Listenmethoden:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.w3schools.com/python/ref_list_append.asp">append()</a></p></li>
<li><p><a class="reference external" href="https://www.w3schools.com/python/ref_list_extend.asp">extend()</a></p></li>
<li><p><a class="reference external" href="https://www.w3schools.com/python/ref_func_max.asp">max(list)</a></p></li>
<li><p><a class="reference external" href="https://www.w3schools.com/python/ref_func_min.asp">min(list)</a></p></li>
</ul>
<p>Wir könnten auch eine Funktion schreiben, welche Listen sortiert.
Wie wäre es mit weiteren Datentypen wie <code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code> oder ihrem ganz eigenen Datentyp?</p>
<p>In dieser Übung haben wir nur die Daten in den Speicher <code class="docutils literal notranslate"><span class="pre">memory</span></code> geschrieben.
Die <em>Kontrolleinheit</em> der <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> haben wir nicht modelliert.
Anstatt <a class="reference internal" href="../02-1/4-information-flow.html#def-register"><span class="std std-ref">Register</span></a> haben wir auf <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Variablen und anstatt des <a class="reference internal" href="../02-1/4-information-flow.html#def-program-counter"><span class="std std-ref">Befehlszählers</span></a> und der Sprungbefehlen, auf <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Schleifen und <code class="docutils literal notranslate"><span class="pre">if</span></code>-Ausdrücke zurückgegriffen.
Wenn Sie mit Ihrem Modell noch näher an die reale <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> herankommen wollen, könnten Sie die Anweisungen ebenfalls in den Speicher packen.
Sie dürften nur die Hardware in <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Befehle gießen, die auf der <a class="reference internal" href="../02-1/4-information-flow.html#def-cpu"><span class="std std-ref">CPU</span></a> auch tatsächlich vorhanden sind.
Damit hätten Sie nur eine endliche Menge von Variablen (je eine pro <a class="reference internal" href="../02-1/4-information-flow.html#def-register"><span class="std std-ref">Register</span></a>) keine Schleifen und nur <code class="docutils literal notranslate"><span class="pre">if</span></code>-Ausdrücke der Form:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">register1</span><span class="p">:</span>
    <span class="n">go_to</span><span class="p">(</span><span class="n">register2</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">go_to</span><span class="p">(</span><span class="n">register3</span><span class="p">)</span>
</pre></div>
</div>
<p>Befehle könnten Sie als eigenen Datentyp modellieren und diese durch eine geeignete Codierung wiederum als Zahlen darstellen.
Der <a class="reference internal" href="../02-1/4-information-flow.html#def-program-counter"><span class="std std-ref">Befehlszähler</span></a> würde eine zentrale Rolle in Ihrem Modell spielen.
Anfangs wäre der Berg von Problemen vor dem Sie stehen gigantisch.
Doch wenn Sie sich erneut Schritt für Schritt voran kämpfen und den Berg in viele kleine Hügel aufteilen, kann auch das gelingen.</p>
</div>
<div class="section" id="memory-klasse">
<h3><span class="section-number">23.3.9. </span>Memory Klasse<a class="headerlink" href="#memory-klasse" title="Link zu dieser Überschrift">¶</a></h3>
<p>Wir haben Ihnen alle Funktionen als Klassenmethoden in die Klasse <code class="docutils literal notranslate"><span class="pre">Memory</span></code> gepackt.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Memory</span><span class="p">():</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">1024</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SUCCESS_CODE</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name_to_dt</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;number&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;char&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;list&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;addr&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">inuse</span> <span class="o">=</span> <span class="p">[</span><span class="kc">False</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">size</span><span class="p">)]</span>

    <span class="k">def</span> <span class="nf">to_data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_to_dt</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">name_to_dt</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>

    <span class="k">def</span> <span class="nf">calc_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">3</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">2</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="mi">3</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>

    <span class="k">def</span> <span class="nf">number_to_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">number</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">number</span> <span class="o">//</span> <span class="mi">256</span><span class="p">,</span> <span class="n">number</span> <span class="o">%</span> <span class="mi">256</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">byte1</span><span class="p">,</span> <span class="n">byte2</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">byte1</span> <span class="o">*</span> <span class="mi">256</span> <span class="o">+</span> <span class="n">byte2</span>

    <span class="k">def</span> <span class="nf">char_to_byte</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">char</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_char</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">byte</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">chr</span><span class="p">(</span><span class="n">byte</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_valid</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">addr</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">addr</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_inuse</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">inuse</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">is_free</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_inuse</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">unfree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="o">+</span><span class="n">i</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inuse</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SUCCESS_CODE</span>

    <span class="k">def</span> <span class="nf">malloc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">):</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">inuse</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">b</span><span class="p">:</span>
                <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">addr</span> <span class="o">+=</span> <span class="n">count</span> <span class="o">+</span> <span class="mi">1</span>
                <span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="n">n_bytes</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">unfree</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">addr</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>

    <span class="k">def</span> <span class="nf">mfree</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="o">+</span><span class="n">i</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">inuse</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SUCCESS_CODE</span>

    <span class="k">def</span> <span class="nf">calc_list_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">n_bytes_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bytes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">m</span> <span class="o">*</span> <span class="n">n_bytes_element</span>

    <span class="k">def</span> <span class="nf">alloc</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">n_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">n_bytes</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">malloc</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">addr</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_type</span>
            <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
                <span class="n">byte_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_to_byte</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_to_byte</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">addr</span>

    <span class="k">def</span> <span class="nf">alloc_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data_type</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">n_bytes</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">n</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>

        <span class="c1"># 1. alloc memory</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">malloc</span><span class="p">(</span><span class="n">n_bytes</span><span class="p">)</span>

        <span class="c1"># 2. initalize meta data (data type of the list and its elements and length of the list)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>
        <span class="n">n_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_to_byte</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_bytes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">n_bytes</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_type</span>
        <span class="k">return</span> <span class="n">addr</span>

    <span class="k">def</span> <span class="nf">free</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="p">):</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">):</span>
                <span class="n">n_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_list_bytes</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">n_bytes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">mfree</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="n">n_bytes</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>

    <span class="k">def</span> <span class="nf">read_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr1</span><span class="p">,</span> <span class="n">addr2</span><span class="p">):</span>
        <span class="n">number1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_number</span><span class="p">(</span><span class="n">addr1</span><span class="p">)</span>
        <span class="n">number2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_number</span><span class="p">(</span><span class="n">addr2</span><span class="p">)</span>
        <span class="n">value</span> <span class="o">=</span> <span class="p">(</span><span class="n">number1</span> <span class="o">+</span> <span class="n">number2</span><span class="p">)</span> <span class="o">%</span> <span class="p">(</span><span class="mi">256</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alloc</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">addr</span>

    <span class="k">def</span> <span class="nf">list_len</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">set_list_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">mem_addr</span> <span class="o">=</span> <span class="n">addr</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
            <span class="n">byte_value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_to_byte</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_value</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">byte_value</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SUCCESS_CODE</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_to_byte</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">SUCCESS_CODE</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>

    <span class="k">def</span> <span class="nf">get_list_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
        <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">calc_bytes</span><span class="p">(</span><span class="n">data_type</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
        <span class="c1">#print(f&quot;bytes: {m}&quot;)</span>
        <span class="c1">#print(f&quot;addr: {addr}&quot;)</span>
        <span class="n">mem_addr</span> <span class="o">=</span> <span class="n">addr</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">+</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_char</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">mem_addr</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">ERROR_CODE</span>

    <span class="k">def</span> <span class="nf">char_to_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_char</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">number_to_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_number</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="o">+</span><span class="mi">2</span><span class="p">]))</span>

    <span class="k">def</span> <span class="nf">list_to_str</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">mylist</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;[&quot;</span>
        <span class="n">length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_len</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>
        <span class="n">element_data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">mylist</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
            <span class="n">value</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">element_data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">element_data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="n">value</span>
            <span class="k">elif</span> <span class="n">element_data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">):</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;, &quot;</span>
        <span class="n">output</span> <span class="o">+=</span> <span class="s2">&quot;]&quot;</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">mem_to_string</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
        <span class="n">output</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">inuse</span><span class="p">[</span><span class="n">addr</span><span class="p">]:</span>
            <span class="n">data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">memory</span><span class="p">[</span><span class="n">addr</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">):</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">char_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">):</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">):</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">list_to_str</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">data_type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">):</span>
                <span class="n">new_addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read_number</span><span class="p">(</span><span class="n">addr</span><span class="p">)</span>
                <span class="n">output</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">new_addr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output</span>

    <span class="k">def</span> <span class="nf">new_primitive_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">data_type</span><span class="p">):</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">mylist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alloc_list</span><span class="p">(</span><span class="n">data_type</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>

        <span class="c1"># fill list</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">mylist</span>

    <span class="k">def</span> <span class="nf">get_data_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;list&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">new_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>
        <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
        <span class="n">mylist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alloc_list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;addr&#39;</span><span class="p">),</span> <span class="n">length</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
            <span class="n">element_data_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_data_type</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">element_data_type</span> <span class="ow">in</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;char&#39;</span><span class="p">)]:</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">alloc</span><span class="p">(</span><span class="n">element_data_type</span><span class="p">,</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_list</span><span class="p">(</span><span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_list_value</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">mylist</span>
</pre></div>
</div>
</div>
</div>
<p>Wenn Sie die Klasse in die Datai <code class="docutils literal notranslate"><span class="pre">mem.py</span></code> packen, sieht der Code zur Verwendung wie folgt aus:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mem</span>
<span class="n">memory_object</span> <span class="o">=</span> <span class="n">mem</span><span class="o">.</span><span class="n">Memory</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="mi">4048</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">memory_object</span><span class="o">.</span><span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">memory_object</span><span class="o">.</span><span class="n">alloc</span><span class="p">(</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">),</span> <span class="mi">130</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">memory_object</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">memory_object</span><span class="o">.</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">z</span><span class="p">))</span>

<span class="n">numbers</span> <span class="o">=</span> <span class="n">memory_object</span><span class="o">.</span><span class="n">new_primitive_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">memory_object</span><span class="o">.</span><span class="n">to_data_type</span><span class="p">(</span><span class="s1">&#39;number&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">memory_object</span><span class="o">.</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">numbers</span><span class="p">))</span>

<span class="n">chars</span> <span class="o">=</span> <span class="n">memory_object</span><span class="o">.</span><span class="n">new_list</span><span class="p">(</span><span class="s2">&quot;Hello World&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">memory_object</span><span class="o">.</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">chars</span><span class="p">))</span>

<span class="n">mixedlist</span> <span class="o">=</span> <span class="n">memory_object</span><span class="o">.</span><span class="n">new_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">memory_object</span><span class="o">.</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">mixedlist</span><span class="p">))</span>

<span class="n">mylist</span> <span class="o">=</span> <span class="n">memory_object</span><span class="o">.</span><span class="n">new_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">,</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="s2">&quot;Hello World&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">memory_object</span><span class="o">.</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">mylist</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>134
[1, 2, 3, 4, 5, 6]
[H, e, l, l, o,  , W, o, r, l, d]
[1, 2, [H, e, l, l, o,  , W, o, r, l, d], 4, 5]
[1, 2, A, [[1, 2], 3, 4], [H, e, l, l, o,  , W, o, r, l, d]]
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="was-soll-das-alles">
<h2><span class="section-number">23.4. </span>Was soll das alles?<a class="headerlink" href="#was-soll-das-alles" title="Link zu dieser Überschrift">¶</a></h2>
<p>Diese Übung scheint absonderlich.
Wir haben uns um viel <code class="docutils literal notranslate"><span class="pre">Python</span></code>-Funktionalität beraubt, um diese dann wieder zu implementieren.
Was soll das alles?</p>
<p>Mit dieser Übung wollten wir Ihnen zeigen, wie viel uns <code class="docutils literal notranslate"><span class="pre">Python</span></code> und andere Hochsprachen abnehmen und was eigentlich hinter den kurzen und überaus mächtigen Befehlen steckt.
Schreiben Sie in <code class="docutils literal notranslate"><span class="pre">Python</span></code> zum Beispiel:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">mylist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, &#39;Hello World&#39;, 4, 5]
</pre></div>
</div>
</div>
</div>
<p>passiert im Hintergrund eine ganze Menge und unsere Funktion</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="n">new_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, [H, e, l, l, o,  , W, o, r, l, d], 4, 5]
</pre></div>
</div>
</div>
</div>
<p>schildert einen Teil davon.
Zunächst einmal gibt es so etwas wie Datentypen.
Ein Element eines Datentyps benötigt einen bestimmten (nicht variablen) Speicherbereich.
Nur deshalb können wir Listenelemente direkt adressieren!
Listen die Elemente unterschiedlicher Datentypen enthalten, enthalten Adressen (<strong>Zeiger</strong>) auf jene Elemente.</p>
<p>Speicher muss reserviert und wieder freigegeben werden.
Es reicht nicht nur den Wert einer Variablen in den Speicher zu schreiben.
Der Datentyp und andere Informationen werden ebenfalls abgelegt.</p>
<p>Wir konnten nur ein Stück weit näher an die Maschine herankommen.
Auch haben wir uns kaum um die Fehlerbehandlung gekümmert.
Was passiert zum Beispiel wenn der Speicher voll belegt ist?
Was passiert wenn eine Adresse <code class="docutils literal notranslate"><span class="pre">addr1</span></code> auf eine andere Adresse <code class="docutils literal notranslate"><span class="pre">addr2</span></code> zeigt und diese wiederum auf <code class="docutils literal notranslate"><span class="pre">addr1</span></code> zeigt?
Wie stellen wir fest, dass keine Adresse mehr auf einen bestimmten Speicherbereich zeigt?</p>
<p>Wenn Sie der Übung folgen konnten, haben Sie ihr Verständnis der Programmausführung auf einem Computer geschärft.
Sie haben aus primitiven Mitteln (einem linearen Speicher aus Zahlen (0 bis 255)) komplexe Strukturen (mehrdimensionale Listen) und Manipulationen errichtet.
Im Endeffekt haben Sie einen kleinen <a class="reference internal" href="../02-1/2-interpretation.html#def-compiler"><span class="std std-ref">Compiler</span></a> geschrieben, der Ihnen den Befehl</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span> <span class="o">=</span> <span class="n">initialize</span><span class="p">(</span><span class="mi">1024</span><span class="p">)</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="n">new_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s2">&quot;Hello World&quot;</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mem_to_string</span><span class="p">(</span><span class="n">mylist</span><span class="p">,</span> <span class="n">memory</span><span class="p">,</span> <span class="n">inuse</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[1, 2, [H, e, l, l, o,  , W, o, r, l, d], 4, 5]
</pre></div>
</div>
</div>
</div>
<p>in eine Folge von maschinennäheren Befehlen umwandelt.
Adressen bzw. <strong>Zeiger</strong> auf andere Speicherobjekte werden Ihnen in Ihrer Programmierlaufbahn immer wieder begegnen.
Sie sind ein essenzielles Konzept der Programmierung, welches Sie auch bei der Programmierung <code class="docutils literal notranslate"><span class="pre">Python</span></code> kennen und verstehen sollten.</p>
<p>Sollten Sie je mit einer Sprache in Kontakt kommen in der Sie den Speicher selbst verwalten müssen (z.B. <code class="docutils literal notranslate"><span class="pre">C/C++</span></code>), so haben Sie hierfür eine erste Verständnisgrundlage.</p>
<div class="exercise admonition" id="memory-management-c-exercise">

<p class="admonition-title"><span class="caption-number">Exercise 23.21 </span> (Speicherverwaltung in C)</p>
<div class="section" id="exercise-content">
<p>Können Sie erraten welche Auswirkungen folgender <code class="docutils literal notranslate"><span class="pre">C</span></code>-Code hat?</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">float</span><span class="o">*</span><span class="p">)</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="kt">float</span><span class="p">));</span><span class="w"></span>
<span class="p">...</span><span class="w"></span>
<span class="n">free</span><span class="p">(</span><span class="n">ptr</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
</div>
</div>
<div class="solution dropdown admonition" id="memory-management-c-solution">

<p class="admonition-title">Solution to<a class="reference internal" href="#memory-management-c-exercise"> Exercise 23.21 (Speicherverwaltung in C)</a></p>
<div class="section" id="solution-content">
<p>Die erste Zeile allokiert einen Speicher für ein Array (Liste) aus Fließkommazahlen (<code class="docutils literal notranslate"><span class="pre">float</span></code>) der größe 100.
<code class="docutils literal notranslate"><span class="pre">ptr</span></code> ist der Zeiger der auf das Array zeigt. <code class="docutils literal notranslate"><span class="pre">free(ptr)</span></code> gibt den Speicher des Arrays frei.</p>
<p>Im Übrigen würden Sie in <code class="docutils literal notranslate"><span class="pre">C</span></code> mit <code class="docutils literal notranslate"><span class="pre">ptr[3]</span> <span class="pre">=</span> <span class="pre">100.3</span></code> den Wert <code class="docutils literal notranslate"><span class="pre">100.3</span></code> an die Stelle <code class="docutils literal notranslate"><span class="pre">3</span></code> des Arrays schreiben und mit <code class="docutils literal notranslate"><span class="pre">&amp;ptr</span></code> erhalten Sie die Speicheradresse des Zeigers.</p>
</div>
</div>
<p>Wir hoffen, dass Sie durch diese Übung den Komfort, den Ihnen die Hochsprachen bieten, zu schätzen lernen.</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "BZoennchen/ct-book",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./chapters/04"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="image-representation.html" title="zurück Seite">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">zurück</p>
            <p class="prev-next-title"><span class="section-number">22. </span>Binäres Zeichnen</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="name-register.html" title="weiter Seite">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">weiter</p>
        <p class="prev-next-title"><span class="section-number">24. </span>Namensregister</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      <div class="extra_footer">
        <div class="container"> <div class="col1"> <a href="https://hm.edu/"> <img style="width:50px;float:right;"" src="/ct-book/_static/img/hm-logo.png" alt="Logo"> </a> <div> <div class="col1"> Verfasst durch <a href="https://www.cs.hm.edu/die_fakultaet/ansprechpartner/mitarbeiter/zoennchen/index.de.html">Benedikt Zönnchen</a>, <a href="https://www.cs.hm.edu/die_fakultaet/ansprechpartner/mitarbeiter/ottinger/index.de.html">Sarah Ottinger</a>, <a href="https://www.cs.hm.edu/die_fakultaet/ansprechpartner/professoren/hobelsberger/index.de.html">Martin Hobelsberger</a> und<br> lizenziert durch <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC BY 4.0</a>. </div> </div>
      </div>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="../../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>